# Quantum entanglement {#quantum-entanglement}

> About the fundamental tool of quantum computing: **entanglement**, via the formalism of **tensor products**, which was the missing ingredient from our previous formalism of quantum theory.
> Also about various **controlled gates**, including the always useful **controlled-$\texttt{NOT}$**.

We now know everything we need to know about a single qubit and its quantum behaviour.
But if we want to understand quantum computation --- a complicated quantum interference of many interacting qubits --- then we will need few more mathematical tools.
Stepping up from one qubit to two or more is a bigger leap than you might expect.
Already, with just two qubits, we will encounter the remarkable phenomenon of quantum entanglement and have a chance to discuss some of the most puzzling features of quantum theory that took people decades to understand.

<lite-youtube videoid="SkKF48vijiw" playlabel="Play: Overview of entanglement"></lite-youtube>




## A small history

The notion of **quantum entanglement** was the subject of many early debates that focused on the meaning of quantum theory.
Back in the 1930s, Albert Einstein, Niels Bohr, Werner Heisenberg, and Erwin Schrödinger (to mention just the usual suspects) were trying hard to understand its conceptual consequences.^[E. Schrödinger, Discussion of probability relations between separated system, _Mathematical Proceedings of the Cambridge Philosophical Society_ **31** (1935), pp. 555--563.]
Einstein, the most sceptical of them all, claimed that it was pointing toward the fatal flaw in quantum theory, and referred to it as "_spooky action-at-a-distance_".
In contrast, Schrödinger was much more prepared to accept quantum theory exactly as it was formulated, along with all its predictions, no matter how weird they might be.
In his 1935 paper, which introduced quantum entanglement, he wrote "I would not call it _one_ but rather _the_ characteristic trait of quantum mechanics, the one that enforces its entire departure from classical lines of thought".
Today we still talk a lot about quantum entanglement, but more often it is viewed as a physical resource which enables us to communicate with perfect security, build very precise atomic clocks, and even teleport small quantum objects!
But what exactly is quantum entanglement?





## One, two, many...

<lite-youtube videoid="Y52d8Awh96g" playlabel="Play: Dimension argument for entanglement"></lite-youtube>

In classical physics, the transition from a single object to a composite system of many objects is trivial: in order to describe the state of, say, 42 objects at any given moment of time, it is sufficient to describe the state of each of the objects separately.
Indeed, the classical state of 42 point-like particles is described by specifying the position and the momentum of each particle.

::: {.idea latex=""}
In the _classical_ world, "the whole is the sum of its parts", but the _quantum_ world is very different.
:::

Consider, for example, a pair of qubits.
Suppose that each one is described by a state vector: the first one by $\ket{a}$, and the second one by $\ket{b}$.
One might therefore think that the most general state of the two qubits should be represented by a pair of state vectors, $\ket{a}\ket{b}$, with one for each qubit.
Indeed, such a state is certainly possible, but there are other states that _cannot_ be expressed in this form.
In order to write down the most general state of two qubits we first focus on the basis states.

For a single qubit we have been using the standard basis $\{\ket{0},\ket{1}\}$.
For two qubits we may choose the following as our standard basis states:^[It looks like we are defining some sort of "multiplication rule" for kets here, saying that $\ket{a}\ket{b}:=\ket{ab}$. This is indeed the case, but to talk about this properly we need to introduce the idea of **tensor products** (which we do [very soon](#tensor-products)).]
$$
  \begin{array}{cc}
    \ket{00} \equiv \ket{0}\ket{0}
    & \ket{01} \equiv \ket{0}\ket{1}
  \\\ket{10} \equiv \ket{1}\ket{0}
    &\ket{11} \equiv \ket{1}\ket{1}.
  \end{array}
$$
Within each ket, the first symbol refers to the first qubit, and the second to the second, and we have tacitly assumed that we can distinguish the two qubits by their location, or some other means.
Now, the most general state of the two qubits is a normalised linear combination of these four basis states, i.e. a vector of the form
$$
  \ket{\psi}
  = c_{00}\ket{00} + c_{01}\ket{01} + c_{10}\ket{10} + c_{11}\ket{11}.
$$
Physical interpretation aside, let us count how many real parameters are needed to specify this state.
Six, right?
We have four complex numbers (eight real parameters) restricted by the normalisation condition, along with the fact that states differing only by a global phase factor are equivalent, which leaves us with six real parameters.
Now, by the same line of argument, we need only two real parameters to specify the state of a single qubit, and hence need four real parameters to specify any state of two qubits of the form $\ket{a}\ket{b}$.
So it cannot be the case that every state of two qubits can be expressed as a pair of states $\ket{a}\ket{b}$, simply for "dimension reasons".

For example, compare the two states of two qubits,
$$
  \begin{gathered}
    \frac{1}{\sqrt 2}\ket{00} + \frac{1}{\sqrt 2}\ket{01}
  \\\text{and}
  \\\frac{1}{\sqrt 2}\ket{00} + \frac{1}{\sqrt 2}\ket{11}.
  \end{gathered}
$$
The first one is **separable**, i.e. we can view it as a pair of state vectors where each one pertains to one of the two qubits:
$$
  \frac{1}{\sqrt 2}\ket{00} + \frac{1}{\sqrt 2}\ket{01}
  = \underbrace{\vphantom{\frac{1}{\sqrt 2}}\ket{0}}_{\text{qubit 1}}
  \;\;
  \underbrace{\frac{1}{\sqrt 2}(\ket{0}+\ket{1})}_{\text{qubit 2}},
$$
The second state, however, does _not_ admit such a decomposition: there do _not_ exist any $\psi_1,\psi_2$ such that
$$
  \frac{1}{\sqrt 2}\ket{00} + \frac{1}{\sqrt 2}\ket{11}
  =
  \ket{\psi_1}\ket{\psi_2}
$$
and so we say that it is an **entangled** state.
Informally, any bipartite state that cannot be viewed as a pair of two states pertaining to the constituent subsystems is said to be entangled.

With this discussion in our minds, we can now give more formal account of the states of composite quantum systems.





## Quantum theory, formally (continued)

Recalling [Chapter 4](#measurements), where we said that we were missing a key part of the formalism of quantum theory, we can now fill in this hole.
Our mathematical formalism of choice behind the quantum theory of composite systems is based on the **tensor product** of Hilbert spaces.

### Tensor products {#tensor-products}

Let the states of some system $\mathcal{A}$ be described by vectors in an $n$-dimensional Hilbert space $\mathcal{H}_{\mathcal{A}}$, and the states of some system $\mathcal{B}$ by vectors in an $m$-dimensional Hilbert space $\mathcal{H}_{\mathcal{B}}$.
The combined system of $\mathcal{A}$ and $\mathcal{B}$ is then described by vectors in the $(nm)$-dimensional **tensor product space** $\mathcal{H}_{\mathcal{A}}\otimes\mathcal{H}_{\mathcal{B}}$.
Given bases $\{\ket{a_1},\ldots,\ket{a_n}\}$ of $\mathcal{H}_{\mathcal{A}}$ and $\{\ket{b_1},\ldots,\ket{b_m}\}$ of $\mathcal{H}_{\mathcal{B}}$, we form a basis of the tensor product by taking the ordered pairs $\ket{a_i}\otimes\ket{b_j}$, for $i=1,\ldots,n$ and $j=1,\ldots,m$.
The tensor product space $\mathcal{H}_{\mathcal{A}}\otimes\mathcal{H}_{\mathcal{B}}$ then consists of all linear combination of such tensor product basis vectors:^[If the bases $\{\ket{a_i}\}$ and $\{\ket{b_j}\}$ are orthonormal then so too is the tensor product basis $\{\ket{a_i}\otimes\ket{b_j}\}$.]
$$
  \ket{\psi}
  = \sum_{ij} c_{ij}\ket{a_i}\otimes\ket{b_j}.
\tag{5.3.1}
$$

The tensor product operation $\otimes$ is distributive:
$$
  \begin{gathered}
    \ket{a} \otimes \left( \beta_1\ket{b_1} + \beta_2\ket{b_2} \right)
    = \beta_1\ket{a}\otimes\ket{b_1} + \beta_2\ket{a}\otimes\ket{b_2}
  \\\left( \alpha_1\ket{a_1} + \alpha_2\ket{a_2} \right) \otimes \ket{b}
    = \alpha_1\ket{a_1}\otimes\ket{b} + \alpha_2\ket{a_2}\otimes\ket{b}.
  \end{gathered}
$$
The tensor product of Hilbert spaces is again a Hilbert space: the inner products on $\mathcal{H}_{\mathcal{A}}$ and $\mathcal{H}_{\mathcal{B}}$ give a natural inner product on $\mathcal{H}_{\mathcal{A}}\otimes\mathcal{H}_{\mathcal{B}}$, defined for any two product vectors by
$$
  \left( \bra{a'}\otimes\bra{b'} \right) \left( \ket{a}\otimes\ket{b} \right)
  = \braket{a'}{a}\braket{b'}{b}
$$
and extended by linearity to sums of tensor products of vectors, and, by associativity^[$({\mathcal{H}}_a \otimes {\mathcal{H}}_b)\otimes {\mathcal{H}}_c = {\mathcal{H}}_a \otimes ({\mathcal{H}}_b\otimes {\mathcal{H}}_c)$.], to any number of subsystems.
Note that the bra corresponding to the tensor product state $\ket{a}\otimes\ket{b}$ is written as $(\ket{a}\otimes\ket{b})^\dagger = \bra{a}\otimes\bra{b}$, where the order of the factors on either side of $\otimes$ does not change when the dagger operation is applied.

Some joint states of $\mathcal{A}$ and $\mathcal{B}$ can be expressed as a single tensor product, say $\ket{\psi}=\ket{a}\otimes\ket{b}$ (often written as $\ket{a}\ket{b}$, or $\ket{a, b}$, or even $\ket{ab}$), meaning that the subsystem $\mathcal{A}$ is in state $\ket{a}$, and the subsystem $\mathcal{B}$ in state $\ket{b}$.
If we expand $\ket{a}=\sum_i\alpha_i\ket{a_i}$ and $\ket{b}=\sum_i\beta_j\ket{b_j}$, then $\ket{\psi}=\sum_{ij}\alpha_i\beta_j\ket{a_i}\otimes\ket{b_j}$ and we see that, for all such states, the coefficients $c_{ij}$ in Equation (5.3.1) are of a rather special form:
$$
  c_{ij} = \alpha_i\beta_j.
$$
We call such states **separable** (or just **product states**).
States that are not separable are said to be **entangled**.

A useful fact about tensor products is that $\lambda a\otimes b = a\otimes\lambda b$ (where $a$ and $b$ are vectors, and $\lambda$ is a scalar).
This means that we don't need to worry about brackets, and can write something like $\lambda(a\otimes b)$.

We will also need the concept of the tensor product of two operators.
If $A$ is an operator on $\mathcal{H}_{\mathcal{A}}$ and $B$ an operator on $\mathcal{H}_{\mathcal{B}}$, then the tensor product operator $A\otimes B$ is an operator on $\mathcal{H}_{\mathcal{A}}\otimes\mathcal{H}_{\mathcal{B}}$ defined by its action on product vectors via
$$
  (A\otimes B)(\ket{a}\otimes\ket{b}) = (A\ket{a})\otimes (B\ket{b})
$$
and with its action on all other vectors determined by linearity:
$$
  A\otimes B \left( \sum_{ij} c_{ij}\ket{a_i}\otimes\ket{b_j} \right)
  = \sum_{ij}c_{ij} A\ket{a_i}\otimes B\ket{b_j}.
$$

::: {.maths}
**!!TO-DO: talk about tensor products via universal properties etc.**
:::






## Back to qubits

Let's see how this formalism works for qubits.
The $n$-fold tensor product of vectors from the standard basis $\{\ket{0},\ket{1}\}$ represent binary strings of length $n$.
For example, for $n=3$,^[We often drop the $\otimes$ symbol, especially when we deal with the standard tensor product basis. For example, a state of a quantum register composed of four qubits holding the binary string $1001$ may be written as $\ket{1}\otimes\ket{0}\otimes\ket{0}\otimes\ket{1}$, as $\ket{1}\ket{0}\ket{0}\ket{1}$, or even simply as $\ket{1001}$.]
$$
  \begin{aligned}
    \ket{0}\otimes\ket{1}\otimes\ket{1}
    & \equiv \ket{011}
  \\\ket{1}\otimes\ket{1}\otimes\ket{1}
    & \equiv \ket{111}.
  \end{aligned}
$$
A _classical_ register composed of three bits can store _only one_ of these two binary strings at any time; a _quantum_ register composed of three qubits can store _both of them_ in a superposition.

Indeed, if we start with the state $\ket{011}$ and apply the Hadamard gate to the first qubit (which is the same as applying $H\otimes\id\otimes\id$), then, given that linear combinations distribute over tensor products, we obtain^[We often simply write $H\otimes H\otimes H$ as $H^{\otimes 3}$.]
$$
  \begin{aligned}
    \ket{011}
    \longmapsto
    &\frac{1}{\sqrt2} \big(\ket{0} + \ket{1}\big) \otimes\ket{1}\otimes\ket{1}
  \\\equiv
    &\frac{1}{\sqrt2} \big(\ket{011} + \ket{111}\big).
  \end{aligned}
$$
In fact, we can even prepare this register in a superposition of all eight possible binary strings: if we apply the tensor product operation $H\otimes H\otimes H$ to the state $\ket{0}\otimes\ket{0}\otimes\ket{0} = \ket{000}$ then we get

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=6}
\begin{equation*}
  \left.
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \qw \rstick{$\frac{\ket{0}+\ket{1}}{\sqrt2}$}
  \\\lstick{$\ket{0}$}
    & \gate{H}
    & \qw \rstick{$\frac{\ket{0}+\ket{1}}{\sqrt2}$}
  \\\lstick{$\ket{0}$}
    & \gate{H}
    & \qw \rstick{$\frac{\ket{0}+\ket{1}}{\sqrt2}$}
  \end{quantikz}
  \right\}
  =
  \frac{1}{2^{3/2}}
  \left\{
    \begin{array}{r}
      \ket{000} + \ket{001} + \ket{010} + \ket{011}
    \\ + \ket{100} + \ket{101} + \ket{110} + \ket{111}
    \end{array}
  \right\}.
\end{equation*}
```

The resulting state is exactly a superposition of all binary string of length 3, and can also be written as
$$
  \frac{1}{\sqrt2} \big(\ket{0} + \ket{1}\big)
  \otimes
  \frac{1}{\sqrt2} \big(\ket{0} + \ket{1}\big)
  \otimes
  \frac{1}{\sqrt2} \big(\ket{0} + \ket{1}\big).
$$

In general, the tensor product operation $H^{\otimes n}$, which means "apply the Hadamard gate to each of your $n$ qubits", is known as the **Hadamard transform**, and it maps product states to product states.
Like the Hadamard gate in the typical quantum interference circuit, the Hadamard transform opens and closes a multi-qubit interference.






## Separable or entangled?

::: {.idea latex=""}
_Most_ vectors in $\mathcal{H}_a\otimes \mathcal{H}_b$ are entangled and _cannot_ be written as product states $\ket{a}\otimes\ket{b}$ with $\ket{a}\in\mathcal{H}_a$ and $\ket{b}\in\mathcal{H}_b$.
:::

In order to see this, let us write any joint state $\ket{\psi}$ of $\mathcal{A}$ and $\mathcal{B}$ in a product basis as
$$
  \begin{aligned}
    \ket{\psi}
    &= \sum_{ij} c_{ij}\ket{a_i}\otimes\ket{b_j}
  \\&= \sum_i\ket{a_i}\otimes\left(\sum_j c_{ij}\ket{b_j}\right)
  \\&= \sum_i\ket{a_i}\otimes\ket{\phi_i}
  \end{aligned}
\tag{5.5.1}
$$
where the $\ket{\phi_i}=\sum_j c_{ij}\ket{b_j}$ are vectors in $\mathcal{H}_{\mathcal{B}}$ that need not be normalised.
For any _product_ state, these vectors have a special form.
Indeed, if $\ket{\psi}= \ket{a}\otimes\ket{b}$ then, after expanding the first state in the $\ket{a_i}$ basis, we obtain
$$
  \ket{\psi}
  = \sum_{i}\ket{a_i}\otimes\left(\sum_i\alpha_i\ket{b}\right).
$$
This expression has the same form as Equation (5.5.1) with $\ket{\phi_i}=\alpha_i\ket{b}$, i.e. each of the $\ket{\phi_i}$ vectors in this expansion is a multiple of the same vector $\ket{b}$.
Conversely, if $\ket{\phi_i} = \alpha_i\ket{b}$ for all $i$ in Equation (5.5.1), then $\ket{\psi}$ must be a product state.^[Even though an entangled state cannot be written as a tensor product, it can always be written as a linear combination of vectors from the tensor product basis. In fact, any state of $n$ qubits $\ket{\psi}$ can be expressed in the standard _product_ basis. In general, given $n$ qubits, we need $2(2^n-1)$ real parameters to describe their state vector, but only $2n$ to describe separable states.]
So if we want to identify which joint states are product states and which are not, we simply write the joint state according to Equation (5.5.1) and check if all the vectors $\ket{\phi_i}$ are multiples of a single vector.
Needless to say, if we choose the states $\ket{\phi}$ randomly, it is very unlikely that this condition is satisfied, and we almost certainly pick an entangled state.

Quantum entanglement is one of the most fascinating aspects of quantum theory.
We will now explore some of its implications.






## Controlled-NOT

<lite-youtube videoid="1PJonQOi5M8" playlabel="Play: Controlled-NOT"></lite-youtube>

How do entangled states arise in real physical situations?
The short answer is that _entanglement is the result of interactions_.
It is easy to see that tensor product operations $U_1\otimes\ldots\otimes U_n$ map product states to product states:

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=6}
\begin{equation*}
  \left.
    \begin{quantikz}
      \lstick{$\ket{\psi_1}$}
      & \gate{U_1}
      & \qw \rstick{$\ket{\psi'_1}$}
    \\[-1em]
      &\vdots&
    \\[-0.5em]
      \lstick{$\ket{\psi_n}$}
      & \gate{U_n}
      & \qw \rstick{$\ket{\psi'_n}$}
    \end{quantikz}
  \right\}
  \ket{\psi'_1}\otimes\ldots\otimes\ket{\psi'_n}
\end{equation*}
```

and so any collection of separable qubits remains separable.

As soon as qubits start interacting with one another, however, they become entangled, and things start to get really interesting.
We will describe interactions that cannot be written as tensor products of unitary operations on individual qubits.
The most popular two-qubit entangling gate is the **controlled-$\texttt{NOT}$** (or $\texttt{c-NOT}$), also known as the **controlled-$X$** gate.^[Here the $X$ refers to the Pauli operator $\sigma_x\equiv X$ that implements the bit-flip.]
The gate acts on two qubits: it flips the second qubit (referred to as the **target**) if the first qubit (referred to as the **control**) is $\ket{1}$, and does nothing if the control qubit is $\ket{0}$.
In the standard basis $\{\ket{00},\ket{01},\ket{10},\ket{11}\}$, it is represented by the following unitary matrix:

::: {.idea latex=""}
| controlled-$\texttt{NOT}$ |
| :--------------: |
| $\left[\begin{array}{c|c}\begin{matrix}1&0\\0&1\end{matrix}&\begin{matrix}0&0\\0&0\end{matrix}\\\hline\begin{matrix}0&0\\0&0\end{matrix}&\begin{matrix}0&1\\1&0\end{matrix}\end{array}\right]$ |
:::

We can also represent the $\texttt{c-NOT}$ gate using the circuit notation, as in Figure \@ref(fig:c-not-diagram).

(ref:c-not-diagram-caption) Where $x,y\in\{0,1\}$, and $\oplus$ denotes $\texttt{XOR}$, or addition modulo 2.

```{r c-not-diagram,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.cap='(ref:c-not-diagram-caption)'}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{x}$}
    & \ctrl{1}
    & \qw \rstick{$\ket{x}$}
  \\\lstick{$\ket{y}$}
    & \targ \qw
    & \qw \rstick{$\ket{x\oplus y}$}
  \end{quantikz}
\end{equation*}
```

Note that this gate does not admit any tensor product decomposition, but can be written as a sum of tensor products:^[Make sure that you understand how the Dirac notation is used here. More generally, think why $$\proj{0}\otimes A + \proj{1}\otimes B$$ means "_if the first qubit is in state $\ket{0}$ then apply $A$ to the second one, and if the first qubit is in state $\ket{1}$ then apply $B$ to the second one_". What happens if the first qubit is in a superposition of $\ket{0}$ and $\ket{1}$?]
$$
  \texttt{c-NOT}
  = \proj{0}\otimes\id + \proj{1}\otimes X
$$
where $X$ is the Pauli bit-flip operation.

The $\texttt{c-NOT}$ gate lets us do many interesting things, and can act in a rather deceptive way.
Let us now study some of these things.






### The Bell states, and the Bell measurement

<lite-youtube videoid="jWzTMtFiG8k" playlabel="Play: Bell states"></lite-youtube>

We start with the generation of entanglement.
Here is a simple circuit that demonstrates the entangling power of $\texttt{c-NOT}$:^[John Stewart Bell (1928--1990) was a Northern Irish physicist.]

:::: {.circuit latex=""}
::: {.circuit_title}
(Generating entanglement).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \ctrl{1}
    & \qw \rstick[wires=2]{$\frac{1}{\sqrt2}(\ket{00}+\ket{11})$}
  \\\lstick{$\ket{0}$}
    & \qw
    & \targ \qw
    & \qw
  \end{quantikz}
\end{equation*}
```
::::

In this circuit, the separable input $\ket{0}\ket{0}$ evolves as
$$
  \begin{aligned}
    \ket{0}\ket{0}
    \xmapsto{H}& \frac{1}{\sqrt2} (\ket{0} + \ket{1}) \ket{0}
  \\=& \frac{1}{\sqrt2}\ket{0}\ket{0} + \frac{1}{\sqrt2}\ket{1}\ket{0}
  \\\xmapsto{\texttt{c-NOT}}& \frac{1}{\sqrt2}\ket{0}\ket{0} + \frac{1}{\sqrt2}\ket{1}\ket{1}
  \end{aligned}
$$
resulting in the entangled output $\frac{1}{\sqrt 2}(\ket{00}+\ket{11})$.
In fact, this circuit implements the unitary operation which maps the standard computational basis into the four entangled states, known as the **Bell states**.

::: {.idea latex=""}
The **Bell states**, $\ket{\psi_{ij}}$, as generated by the above circuit:
$$
  \begin{aligned}
    \ket{00}
    &\mapsto
    \ket{\psi_{00}} = \frac{1}{\sqrt 2}(\ket{00}+\ket{11})
  \\\ket{01}
    &\mapsto
    \ket{\psi_{01}} = \frac{1}{\sqrt 2}(\ket{01}+\ket{10})
  \\\ket{10}
    &\mapsto
    \ket{\psi_{10}} = \frac{1}{\sqrt 2}(\ket{00}-\ket{11})
  \\\ket{11}
    &\mapsto
    \ket{\psi_{11}} = \frac{1}{\sqrt 2}(\ket{01}-\ket{10})
  \end{aligned}
$$
The more standard notation for these states, however, is the following:
$$
  \begin{aligned}
    \Phi^+ &= \ket{\psi_{00}}
  \\\Psi^+ &= \ket{\psi_{01}}
  \\\Phi^- &= \ket{\psi_{10}}
  \\\Psi^-&= \ket{\psi_{11}}
  \end{aligned}
$$
(and this is the notation that we will use from now on).
:::

The Bell states form an orthonormal basis in the Hilbert space $\mathcal{H}_1\otimes\mathcal{H}_2$ of two qubits.
We can perform measurements in the Bell basis: the easiest way to do it in practice is to "rotate" the Bell basis to the standard basis, and then perform the measurement in the standard basis.^[For any state $\ket{\psi}$ of two qubits, the amplitude $\braket{\psi_{xy}}{\psi}$ can be written as $\braket{xy}{U^\dagger|\psi}$, where $U^\dagger$ is such that $\ket{\psi_{xy}} = U\ket{xy}$.]
Indeed, if we reverse the circuit, then we get a circuit which maps the Bell state $\ket{\psi_{xy}}$ to the corresponding state $\ket{xy}$ in the standard basis.
This unitary mapping allows us to "implement" the projections on Bell states by applying the reversed circuit followed by the usual qubit-by-qubit measurement in the standard basis.






### Quantum teleportation

<lite-youtube videoid="lbrO_0EImZ4" playlabel="Play: Quantum teleportation"></lite-youtube>

A wonderful fact, that sounds more like science fiction than actual science, is the following: _an unknown quantum state can be teleported from one location to another._
Consider the following circuit:^[_Divide et impera_, or "divide and conquer": a good approach to solving problems in mathematics (and in life). Start with the smaller circuits in the dashed boxes.]

:::: {.circuit latex=""}
::: {.circuit_title}
(Quantum teleportation).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\alpha\ket{0}+\beta\ket{1}$}
    & \qw
    & \qw
    & \ctrl{1} \gategroup[wires=2,steps=2,style={inner sep=0.1em,dashed,rounded corners}]{}
    & \gate{H}
    & \qw \rstick{$\ket{x}$}
  \\\lstick{$\ket{0}$}
    & \gate{H} \gategroup[wires=2,steps=2,style={inner sep=0.1em,dashed,rounded corners}]{}
    & \ctrl{1}
    & \targ \qw
    & \qw
    & \qw \rstick{$\ket{y}$}
  \\\lstick{$\ket{0}$}
    & \qw
    & \targ \qw
    & \qw
    & \qw
    & \qw \rstick{$\ket{\psi}$}
  \end{quantikz}
\end{equation*}
```
::::

The first input qubit (counting from the top) is in some arbitrary state.
After the action of the part of the circuit in the first dashed box (counting from the left), the state of the three qubits reads^[We neglect to write the normalisation factors.]
$$
  \big( \alpha\ket{0}+\beta\ket{1} \big)
  \big( \ket{00}+\ket{11} \big).
$$
By regrouping the terms, but keeping the qubits in the same order, this state can be written as the sum
$$
  \begin{aligned}
    &(\ket{00} + \ket{11}) \otimes (\alpha\ket{0} + \beta\ket{1})
  \\+ &(\ket{01} + \ket{10}) \otimes (\alpha\ket{1} + \beta\ket{0})
  \\+ &(\ket{00} - \ket{11}) \otimes (\alpha\ket{0} - \beta\ket{1})
  \\+ &(\ket{01} - \ket{10}) \otimes (\alpha\ket{1} - \beta\ket{0}).
  \end{aligned}
$$
Then the part of the circuit in the second dashed box maps the four Bell states of the first two qubits to the corresponding states from the computational basis:
$$
  \begin{aligned}
    &\ket{00} \otimes (\alpha\ket{0} + \beta\ket{1})
  \\+ &\ket{01} \otimes (\alpha\ket{1} + \beta\ket{0})
  \\+ &\ket{10} \otimes (\alpha\ket{0} - \beta\ket{1})
  \\+ &\ket{11} \otimes (\alpha\ket{1} - \beta\ket{0}).
  \end{aligned}
$$
Upon performing the standard measurement and learning the values of $x$ and $y$, we choose one of the four following transformations depending on these values:
$$
  \begin{array}{ll}
    00 \mapsto \id
    &\quad 01 \mapsto X
  \\[1em]
    10 \mapsto Z
    &\quad 11 \mapsto ZX
  \end{array}
\tag{5.6.2}
$$
(e.g. if $x=0$ and $y=1$, then we choose $X$).
We then apply this transformation to the third qubit, which restores the original state of the first qubit.

If you understand how this circuit works then you are ready for quantum teleportation.
Here is a dramatic version.


> Suppose three qubits, which look very similar, are initially in the possession of an absent-minded Oxford student, Alice.
> The first qubit is in a precious quantum state and this state is needed urgently for an experiment in Cambridge.
> The other two qubits are entangled, in the $\ket{\psi_{00}}$ state. Alice's colleague, Bob, pops in to collect the qubit.
> Once he is gone, Alice realises that, by mistake, she gave him not the first but the third qubit: the one which is entangled with the second qubit.
> 
> ```{r, engine='tikz',fig.width=4}
> \newcommand{\ket}[1]{|#1\rangle}
> \begin{tikzpicture}
>   \draw (0,0) circle (0.25cm) node {2};
>   \draw (0,0.75) circle (0.25cm) node {1};
>   \node at (0,-0.75) {Alice,};
>   \node at (0,-1.1) {in Oxford};
>   %
>   \draw (5,0) circle (0.25cm) node {3};
>   \node at (5,-0.75) {Bob,};
>   \node at (5,-1.1) {in Cambridge};
>   %
>   \draw [<->,dashed] (0.5,0) to node [above] {\small$\frac{1}{\sqrt2}(\ket{00}+\ket{11})$} (4.5,0);
> \end{tikzpicture}
> ```
> 
> The situation seems to be hopeless --- Alice does not know the quantum state of the first qubit, and Bob is now miles away and her communication with him is limited to few bits.
> However, Alice and Bob are both very clever and they both diligently attended their "Introduction to Quantum Information Science" classes.
> Can Alice rectify her mistake and save Cambridge science?
> 
> Hmmm... (pause for thought)...
> 
> Of course: Alice can teleport the state of the first qubit!
> She performs the Bell measurement on the first two qubits, which gives her two binary digits, $x$ and $y$.
> She then broadcasts $x$ and $y$ to Bob, who chooses the corresponding transformation, as in Equation (5.6.2), performs it, and recovers the original state.

This raises a natural "philosophical" question: what do we really _mean_ by teleportation?
A key part of this question is understanding what happens to our original qubit when we teleport it.
As it turns out, it must necessarily be _destroyed_, as we now explain.






### Thou shalt not clone

<lite-youtube videoid="sy3I932usMQ" playlabel="Play: Quantum cloning"></lite-youtube>

Let us now look at something that controlled-$\texttt{NOT}$ _seems_ to be doing but, in fact, _isn't_.
It is easy to see that the $\texttt{c-NOT}$ can copy the bit value of the first qubit:
$$
  \ket{x}\ket{0} \xmapsto{\texttt{c-NOT}} \ket{x}\ket{x}
  \qquad\text{(for $x=0,1$)}
$$
so one might suppose that this gate could also be used to copy superpositions, such as $\ket{\psi} = \alpha\ket{0}+\beta\ket{1}$, so that
$$
  \ket{\psi}\ket{0} \xmapsto{\texttt{c-NOT}} \ket{\psi}\ket{\psi}
$$
for any $\ket{\psi}$.

**This is not so!**

The unitarity of the $\texttt{c-NOT}$ means that it turns superpositions in the control qubit into _entanglement_ of the control and the target: if the control qubit is in the a superposition state $\ket{\psi} = \alpha\ket{0}+\beta\ket{1}$ (with $\alpha,\beta\neq0$), and the target is in $\ket{0}$, then the $\texttt{c-NOT}$ gate generates the entangled state
$$
  \big( \alpha\ket{0}+\beta\ket{1} \big) \ket{0}
  \xmapsto{\texttt{c-NOT}}
  \alpha\ket{00} + \beta\ket{11}.
$$
In fact, it is _impossible_ to clone an unknown quantum state, and we can prove this!

To prove this via contradiction, let's assume that we _could_ build a universal quantum cloner, and then take any two normalised states $\ket{\psi}$ and $\ket{\phi}$ that are _non-identical_ (i.e. $|\braket{\psi}{\phi}|\neq1$) and _non-orthogonal_ (i.e. $\braket{\psi}{\phi}\neq0$).
If we then run our hypothetical cloning machine we get
$$
  \begin{aligned}
    \ket{\psi}\ket{0}\ket{W}
    &\mapsto \ket{\psi}\ket{\psi}\ket{W'}
  \\\ket{\phi}\ket{0}\ket{W}
    &\mapsto \ket{\phi}\ket{\phi}\ket{W''}
  \end{aligned}
$$
where the third system, initially in state $\ket{W}$, represents everything else (say, the internal state of the cloning machine).
For this transformation to be unitary, it must preserve the inner product, and so we require that
$$
  \braket{\psi}{\phi}
  = \braket{\psi}{\phi}^2 \braket{W'}{W''}
$$
which can only be satisfied if $|\braket{\psi}{\phi}|$ is equal to $1$ or $0$, but this contradicts our assumptions!

Thus, states of qubits, unlike states of classical bits, cannot be faithfully cloned.
Note that, in quantum teleportation, the original state must therefore be _destroyed_, since otherwise we would be producing a clone of an unknown quantum state.
The no-cloning property of quantum states leads to interesting applications, of which quantum cryptography is one.

::: {.idea latex=""}
Universal quantum cloners are _impossible_.
:::






## Other controlled gates

### Controlled-phase

Needless to say, not everything is about the controlled-$\texttt{NOT}$ gate.
Another common two-qubit gate is the **controlled-phase** gate $\texttt{c-}P_\varphi$.

::: {.idea latex=""}
| controlled-phase |
| :--------------: |
| $\left[\begin{array}{c|c}\begin{matrix}1&0\\0&1\end{matrix}&\begin{matrix}0&0\\0&0\end{matrix}\\\hline\begin{matrix}0&0\\0&0\end{matrix}&\begin{matrix}1&0\\0&e^{i\varphi}\end{matrix}\end{array}\right]$ |
:::

We can also represent the $\texttt{c-}P_\varphi$ gate using the circuit notation, as in Figure \@ref(fig:c-phase-diagram).

(ref:c-phase-diagram-caption) Where $x,y\in\{0,1\}$.

```{r c-phase-diagram,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.cap='(ref:c-phase-diagram-caption)'}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{x}$}
    & \ctrl{1}
    & \qw \rstick[wires=2]{$e^{ixy\varphi}\ket{x}\ket{y}$}
  \\\lstick{$\ket{y}$}
    & \ctrl{-1} \qw
    & \qw
  \end{quantikz}
\end{equation*}
```

Again, the matrix is written in the computational basis $\{\ket{00},\ket{01},\ket{10},\ket{11}\}$.
If we do not specify the phase then we usually assume that $\varphi=\pi$, in which case we call this operation the **controlled-$Z$ gate**, which acts as $\proj{0}\otimes\id + \proj{1}\otimes Z$.
Here $Z$ refers again to the Pauli phase-flip $\sigma_z\equiv Z$ operation.

In order to see the entangling power of the controlled-phase shift gate, consider the following circuit.

:::: {.circuit latex=""}
::: {.circuit_title}
(Generating entanglement, again).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \ctrl{1}
    & \qw
  \\\lstick{$\ket{0}$}
    & \gate{H}
    & \ctrl{-1}
    & \qw
  \end{quantikz}
\end{equation*}
```
::::

In this circuit, first the two Hadamard gates prepare the equally-weighted superposition of all states from the computational basis

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \qw \rstick[wires=2]{$\frac12\big(\ket{00}+\ket{01}+\ket{10}+\ket{11}\big)$}
  \\\lstick{$\ket{0}$}
    & \gate{H}
    & \qw
  \end{quantikz}
\end{equation*}
```

and then the controlled-$Z$ operation flips the sign in front of $\ket{11}$

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \ctrl{1}
    & \qw \rstick[wires=2]{$\frac12\big(\ket{00}+\ket{01}+\ket{10}-\ket{11}\big)$}
  \\\lstick{$\ket{0}$}
    & \gate{H}
    & \ctrl{-1}
    & \qw
  \end{quantikz}
\end{equation*}
```

which results in the entangled state.





### Controlled-U

Both the above two-qubit controlled gates (i.e. $\texttt{c-NOT}$ and $\texttt{c-}P_\varphi$) are specific examples of the more general construction of a **controlled-$U$ gate**:
$$
  \texttt{c-}U
  =
  \proj{0}\otimes\id + \proj{1}\otimes U
$$
where $U$ is an arbitrary single-qubit unitary transformation $U$.

::: {.idea latex=""}
| controlled-$U$ |
| :--------------: |
| $\left[\begin{array}{c|c}\begin{matrix}1&0\\0&1\end{matrix}&\begin{matrix}0&0\\0&0\end{matrix}\\\hline\begin{matrix}0&0\\0&0\end{matrix}&U\end{array}\right]$ |
:::

We can also represent the $\texttt{c-}U$ gate using the circuit notation, as in Figure \@ref(fig:c-U-diagram).

(ref:c-U-diagram-caption) Where $x,y\in\{0,1\}$.

```{r c-U-diagram,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.cap='(ref:c-U-diagram-caption)'}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{x}$}
    & \ctrl{1}
    & \qw
  \\\lstick{$\ket{y}$}
    & \gate{U}
    & \qw
  \end{quantikz}
\end{equation*}
```

We can go even further and consider a more general unitary operation: the two-qubit **$x$-controlled-$U$ gate**:
$$
  \sum_x \proj{x}\otimes U_x
  \equiv
  \proj{0}\otimes U_0 + \proj{1}\otimes U_1
$$
where each $U_x$ is a unitary transformation that is applied to the second qubit only if the first one is in state $\ket{x}$.
In general, an $x$-controlled-$U$ gate can be defined on two registers of arbitrary size $n$ and $m$, with $x\in\{0,1\}^n$ and the $U_x$ being $(2^m\times 2^m)$ unitary matrices acting on the second register.





### Phase kick-back

Before moving on to the next section, we first describe a simple "trick" --- an unusual way of introducing phase shifts that will be essential for our analysis of quantum algorithms.
Consider the following circuit.

:::: {.circuit latex=""}
::: {.circuit_title}
(Controlled-$U$ interference).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \ctrl{1}
    & \gate{H}
    & \qw \rstick{$\cos\frac{\varphi}{2}\ket{0} - i\sin\frac{\varphi}{2}\ket{1}$}
  \\\lstick{$\ket{u}$}
    & \qw
    & \gate{U}
    & \qw
    & \qw \rstick{$\ket{u}$}
  \end{quantikz}
\end{equation*}
```
where $\ket{u}$ is an _eigenstate_ of $U$ (that is, $U\ket{u} = e^{i\varphi}\ket{u}$ for some $\varphi$).
::::

This should look familiar: it is the usual interference circuit, but with the phase gate replaced by a controlled-$U$ gate, which will mimic the phase gate, as we shall soon see.
Note that the second qubit is prepared in state $\ket{u}$, which is _required to be an eigenstate of $U$_.
The circuit effects the following sequence of transformations (omitting the normalisation factors):
$$
  \begin{aligned}
    \ket{0}\ket{u}
    &\xmapsto{H}
    (\ket{0}+\ket{1})\ket{u}
  \\&\quad = \ket{0}\ket{u} + \ket{1}\ket{u}
  \\&\xmapsto{\texttt{c-}U}
    \ket{0}\ket{u} + \ket{1}U\ket{u}
  \\&\quad = \ket{0}\ket{u} + e^{i\varphi}\ket{1}\ket{u}
  \\&\quad = (\ket{0} + e^{i\varphi}\ket{1}) \ket{u}
  \\&\xmapsto{H}
    \left(
      \cos\frac{\varphi}{2}\ket{0}
      - i\sin\frac{\varphi}{2}\ket{1}
    \right) \ket{u}.
  \end{aligned}
$$
Note that the second qubit does _not_ get entangled with the first one: it remains in its original state $\ket{u}$.
However, the interaction between the two qubits introduces a phase shift on the first qubit.
This may look like an unnecessarily complicated way of introducing phase shifts, but, as we shall soon see, this is how quantum computers do it.
Let me give you a preview of things to come.

Consider the following $x$-controlled-$U$ operation:
$$
  \begin{gathered}
    \left[
      \begin{array}{cccc}
        \id & 0 & 0 & 0
      \\0 & \id & 0 & 0
      \\0 & 0 & \id & 0
      \\0 & 0 & 0 & X
      \end{array}
    \right]
  \\[1em]
    =\proj{00}\otimes\id
  \\+ \proj{01}\otimes\id
  \\+ \proj{10}\otimes\id
  \\+ \proj{11}\otimes X.
  \end{gathered}
$$
The first register is of size $2$, and the second register is of size $1$.
If the first register is prepared in state $\ket{11}$, then the qubit in the second register is flipped (by the Pauli bit-flip $X$); otherwise, nothing happens.
This unitary operation is a quantum version of the Boolean function evaluation: it corresponds to the Boolean function
$$
  \begin{aligned}
    f\colon\{0,1\}^2 &\to \{0,1\}
  \\00&\mapsto0
  \\01&\mapsto0
  \\10&\mapsto0
  \\11&\mapsto1.
  \end{aligned}
$$
If $f(x)=1$, then we flip the bit value in the second register (with operation $X$); if $f(x)=0$, then we do nothing.

Now, prepare the qubit in the second register in state $\ket{0}-\ket{1}$, which is an eigenstate of $X$ with eigenvalue $e^{\pi i}=-1$.
So whenever $X$ is applied to the second register, the phase factor $-1$ appears in front of the corresponding term in the first register.
If we prepare the first register in the superposition $\ket{00}+\ket{01}+\ket{10}+\ket{11}$ then the result of applying the above $x$-controlled-$U$ operation is the entangled state $\ket{00}+\ket{01}+\ket{10}-\ket{11}$.
That is, _the phase kick-back mechanism introduced a relative phase in the equally-weighted superposition of all binary strings of length two_.

::: {.idea latex=""}
Phase kick-back is how we control quantum interference in quantum computation.
:::

We will return to this topic later on, when we discuss quantum evaluation of Boolean functions and quantum algorithms.






### Universality, revisited

<lite-youtube videoid="IzyAY6US5C4" playlabel="Play: Universal sets of gates (for multiple qubits)"></lite-youtube>

We will come across few more gates in this course, but at this stage you already know all the elementary unitary operations that are needed to construct any unitary operation on any number of qubits:

- the Hadamard gate,
- all phase gates, and
- the $\texttt{c-NOT}$

These gates form a **universal set of gates**: with $O(4^{n}n)$ of these gates, we can construct any $n$-qubit unitary operation.^[Recall the big-$O$ asymptotic notation: given a _positive_ function $f(n)$, we write $O(f(n))$ to mean "bounded above by $c\,f(n)$ for some constant $c > 0$ (for sufficiently large $n$)". For example, $15n^2+4n+7$ is $O(n^2)$.]
We should mention that there are many universal sets of gates.
In fact, almost any gate that can entangle two qubits can be used as a universal gate.

We are particularly interested in any _finite_ universal set of gates (such as the one containing the Hadamard, $P_{\frac{\pi}{4}}$ (the $T$ gate), and the $\texttt{c-NOT}$), which can approximate any unitary operation on $n$ qubits with arbitrary precision.
The price to pay is the number of gates --- better precision requires more gates.
We shall elaborate on this later.





### Density operators and the like

The existence of entangled states leads to an obvious question: if we cannot attribute a state vector to an individual qubit, then how can we describe its quantum state?
In the next few chapters we will see that, when we limit our attentions to a part of a larger system, states are not represented by vectors, measurements are not described by orthogonal projections, and evolution is not unitary.
As a spoiler, here is a dictionary of some of the new concepts that will soon be introduced:

| | | |
| -: | :-: | :- |
| state vectors | $\longmapsto$ | density operators |
| unitary evolutions | $\longmapsto$ | completely-positive trace-preserving maps |
| orthogonal projectors | $\longmapsto$ | positive operator-valued measures |







## Why qubits, subsystems, and entanglement?

<lite-youtube videoid="0AU6U7bcEh0" playlabel="Play: Why qubits?"></lite-youtube>

One question that is rather natural to ask at this point is the following:

> If entanglement is so fragile and difficult to control, then why bother?
> Why not perform the whole computation in one physical system that has as many quantum states as we normally have labels for the states of qubits, so that we can label these quantum states in the same way as we normally label the qubits, and give _them_ computational meaning?

This suggestion, although possible, gives a very inefficient way of representing data (it is describing the **unary encoding**).
For serious computations _we need subsystems_.
Here is why.

Suppose you have $n$ physical objects, and each object has $k$ distinguishable states.
If you can access each object _separately_ and put it into any of the $k$ states, then, with only $n$ operations, you can prepare any of the $k^{n}$ different configurations of the combined systems.
Without any loss of generality, let us take $k=2$ and refer to each object of this type as a **physical bit**.
We label the two states of a physical bit as $0$ and $1$.
Any collection of $n$ physical bits can be prepared in $2^{n}$ different configurations, which can be used to store up to $2^{n}$ messages/binary strings/different numbers.
In order to represent numbers from $0$ to $N-1$ we just have to choose $n$ such that $N\leq 2^n$.

Suppose the two states in the physical bit are separated by the energy difference $\Delta E$.
Then a preparation of any particular configuration will cost no more than $E=n \Delta E=(\log_2 N)\Delta E$ units of energy.

In contrast, if we choose to encode $N$ configurations into one chunk of matter, say, into the first $N$ energy states of a single harmonic oscillator with the interstate energy separation $\Delta E$ then, in the worst case, one has to use $E=N\Delta E$ units of energy, e.g. to go from the ground state (labelled as $0$) to the most excited state (labelled as $N$).
For large $N$ this gives an exponential gap in the energy expenditure between the binary encoding using physical bits and unary encoding, using energy levels of harmonic oscillators.

One can, of course, try to switch from harmonic oscillators to quantum systems which have a finite spread in the energy spectrum.
For example, by operating on the energy states of the hydrogen atom one can encode any number from $0$ to $N-1$, and one is guaranteed not to spend more than $E_{\mathrm{max}}=$ $13.6\,\mathrm{eV}$ (otherwise the atom is ionised).
The snag is that, in this case, some of the electronic states will be separated by the energy difference to the order of $E_{\mathrm{max}}/N$, and to drive the system selectively from one state to another one has to tune into the frequency $E_{\mathrm{max}}/\hbar N$, which requires a sufficiently long wave-packet (so that the frequency is well defined), and consequently the
interaction time is of order $N(\hbar/E_{\mathrm{max}})$.

That is, we have to trade energy for time.

It turns out that whichever way we try to represent the number $N$ using the unary encoding (i.e. using $N$ different states of a single chunk of matter), we end up depleting our physical resources (such as energy, time, space) at a much greater rate than in the case when we use subsystems.
This plausibility argument indicates that, for efficient processing of information, the system must be divided into subsystems --- for example, into physical bits.






## *Remarks and exercises* {#remarks-and-exercises-5}

### Entangled or not?

<lite-youtube videoid="lHTSQxii0t0" playlabel="Play: Shared randomness"></lite-youtube>

Let a joint state of $\mathcal{A}$ and $\mathcal{B}$ be written in a product basis as
$$
  \ket{\psi} = \sum_{ij} c_{ij}\ket{a_i}\otimes\ket{b_j}.
$$
Assume that $\mathcal{H}_a$ and $\mathcal{H}_b$ are of the same dimension.

1. Show that, if $\ket{\psi}$ is a product state, then $\det (c_{ij}) = 0$.

2. Show that the converse ($\det(c_{ij})=0$ implies that $\ket{\psi}$ is a product state) holds only for qubits. Explain why.

3. Deduce that the state
    $$
      \frac12\big(\ket{00} + \ket{01} + \ket{10} + (-1)^k\ket{11}\big)
    $$
    is entangled for $k=1$ and unentangled for $k=0$. Express the latter case explicitly as a product state.

There is a lot of interesting physics behind the previous innocuous-looking mathematical statement.
For example, think again about the state $(\ket{00}+\ket{11})/\sqrt2$.
What happens if you measure just the first qubit?
It is equally likely that you get $\ket{0}$ or $\ket{1}$, right?
But after your measurement the two qubits are either in state $\ket{00}$ or in $\ket{11}$, i.e. they show the same bit value.
Now, why might that be disturbing?
Well, imagine the second qubit to be light-years away from the first one.
It seems that the measurement of the first qubit affects the second qubit right away, which seems to imply faster-than-light communication!
This is what Einstein called "spooky action as a distance".^["Spooky action at a distance" is a loose translation of the German "spukhafte Fernwirkung", which is the phrase that Albert Einstein used in his 1947 letter to Max Born.]
But can you actually use this effect to send a message faster than light?
What would happen if you tried?

Hopefully you can see that it would not work, since the result of the measurement is random --- you cannot choose the bit value you want to send.
We shall return to this, and other related phenomena, later on.



### SWAP circuit

Show that, for any states $\ket{\psi_1}$ and $\ket{\psi_2}$, the circuit below implements the $\texttt{SWAP}$ operation $\ket{\psi_1}\ket{\psi_2} \mapsto \ket{\psi_2}\ket{\psi_1}$.

:::: {.circuit latex=""}
::: {.circuit_title}
(Swapping).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{\psi_1}$}
    & \ctrl{1}
    & \targ \qw
    & \ctrl{1}
    & \qw \rstick{$\ket{\psi_2}$}
  \\\lstick{$\ket{\psi_2}$}
    & \targ \qw
    & \ctrl{-1}
    & \targ \qw
    & \qw \rstick{$\ket{\psi_1}$}
  \end{quantikz}
\end{equation*}
```
::::


### Controlled-NOT circuit

Show that the circuit below implements the controlled-$\texttt{NOT}$ gate.

:::: {.circuit latex=""}
::: {.circuit_title}
(Controlled-$\texttt{NOT}$, again).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \qw & \qw & \ctrl{1} & \qw & \qw
  \\\qw & \gate{H} & \ctrl{-1} & \gate{H} & \qw
  \end{quantikz}
\end{equation*}
```
::::


### Measuring with controlled-NOT

The controlled-$\texttt{NOT}$ gate can act as a measurement gate: if you prepare the target in state $\ket{0}$ then the gate acts as $\ket{x}\ket{0}\mapsto\ket{x}\ket{x}$, and so the target learns the bit value of the control qubit.
If you wish, you can think about a subsequent measurement of the target qubit in the computational basis as an observer learning about the bit value of the control qubit.

Take a look at the circuit below, where $M$ stands for measurement in the standard basis.

:::: {.circuit latex=""}
::: {.circuit_title}
(?).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick[wires=2]{$\ket{\psi}$}
    & \ctrl{2}
    & \qw
    & \qw
  \\[-1em]
    \qw
    & \qw
    & \ctrl{1}
    & \qw
  \\\lstick{$\ket{0}$}
    & \targ \qw
    & \targ \qw
    & \meterD{M}
  \end{quantikz}
\end{equation*}
```
::::

Now assume that the top two qubits are in the state
$$
  \ket{\psi}
  = \frac{1}{\sqrt3}\big( \ket{01} - \ket{10} + i\ket{11} \big).
$$
The measurement $M$ gives two outcomes: $0$ and $1$.
What are the probabilities of each outcome, and what is the post-measurement state in each case?
Further, what is actually being measured here?


### Arbitrary controlled-U on two qubits

Any unitary operation $U$ on a single qubit can be expressed as
$$
  U = B^\dagger XBA^\dagger XA
$$
where $X\equiv\sigma_x$ is the Pauli bit-flip operator, and $A$ and $B$ are unitaries.
Suppose that you can implement any single qubit gate, and that you have a bunch of controlled-$\texttt{NOT}$ gates at your disposal.
How would you implement any controlled-$U$ operation on two qubits?


### Entangled qubits

Two entangled qubits in the state $\frac{1}{\sqrt2}(\ket{00}+\ket{11})$ are generated by some source $S$.
One qubit is sent to Alice, and one to Bob, who then both perform measurements in the computational basis.

1. What is the probability that Alice and Bob will register identical results?
    Can any correlations they observe be used for instantaneous communication?

2. Prior to the measurements in the computational basis, Alice and Bob apply unitary operations $R_\alpha$ and $R_\beta$ (respectively) to their respective qubits:

    ```{r,engine='tikz',fig.width=4}
    \definecolor{primary}{RGB}{177,98,78}
    \definecolor{secondary}{RGB}{91,132,177}
    \begin{tikzpicture}
      \draw (0,0) circle (0.4cm) node {$S$};
      \draw [->,primary] (0.3,0.3) to (1,1) to (3.8,1) node [right] {Alice};
      \draw [->,secondary] (0.3,-0.3) to (1,-1) to (3.8,-1) node [right] {Bob};
      \node [draw,fill=white] at (2,1) {$R_\alpha$};
      \draw [fill=gray!15] (3,0.7) arc (-90:90:0.3cm) to cycle;
      \node [draw,fill=white] at (2,-1) {$R_\beta$};
      \draw [fill=gray!15] (3,-1.3) arc (-90:90:0.3cm) to cycle;
    \end{tikzpicture}
    ```

    The gate $R_\theta$ is defined by its action on the basis states:
    $$
      \begin{aligned}
        \ket{0}
        &\longmapsto
        \cos\theta\ket{0} + \sin\theta\ket{1}
      \\\ket{1}
        &\longmapsto
        -\sin\theta\ket{0} + \cos\theta\ket{1}.
      \end{aligned}
    $$
    Show that the state of the two qubits prior to the measurements is
    $$
      \begin{aligned}
        &\frac{1}{\sqrt2}\cos(\alpha-\beta)\big( \ket{00} + \ket{11} \big)
      \\- &\frac{1}{\sqrt2}\sin(\alpha-\beta)\big( \ket{01} - \ket{10} \big).
      \end{aligned}
    $$

3. What is the probability that Alice and Bob's outcomes are identical?


### Quantum dense coding

**!!!TO-DO!!!**


### Playing with conditional unitaries

The swap gate $S$ on two qubits is defined first on product vectors by $S\colon\ket{a}\ket{b}\mapsto\ket{b}\ket{a}$ and then extended to sums of product vectors by linearity.

1. Show that the four Bell states $\frac{1}{\sqrt2}(\ket{00}\pm\ket{11})$ and $\frac{1}{\sqrt2}(\ket{01}\pm\ket{10})$ are eigenvectors of $S$ that form an orthonormal basis in the Hilbert space associated to two qubits.
    Which Bell states span the _symmetric subspace_ (i.e. the space spanned by all eigenvectors with eigenvalue $1$), and which the _antisymmetric_ one (i.e. that spanned by eigenvectors with eigenvalue $-1$)?
    Can $S$ have any eigenvalues apart from $\pm1$?

2. Show that $P_\pm = \frac12(\id\pm S)$ are two orthogonal projectors which form the decomposition of the identity and project on the symmetric and antisymmetric subspaces.
    Decompose the state vector $\ket{a}\ket{b}$ of two qubits into symmetric and antisymmetric components.

3. Consider the quantum circuit below, composed of two Hadamard gates, one controlled-$S$ operation (also known as the **controlled-swap**, or **Fredkin** gate), and the measurement $M$ in the computational basis.
    Suppose that the state vectors $\ket{a}$ and $\ket{b}$ are normalised but _not_ orthogonal to one another.
    Step through the execution of this network, writing down the quantum states of the three qubits after each computational step.
    What are the probabilities of observing $0$ or $1$ when the measurement $M$ is performed?

:::: {.circuit latex=""}
::: {.circuit_title}
(Symmetric and antisymmetric projection).
:::

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \lstick{$\ket{0}$}
    & \gate{H}
    & \ctrl{1}
    & \gate{H}
    & \meterD{M}
  \\[1em]
    \lstick{$\ket{a}$}
    & \qw
    & \gate[wires=2][1cm]{S}
    & \qw
    & \qw
  \\[-1em]
    \lstick{$\ket{b}$}
    & \qw
    & & \qw
    & \qw
  \end{quantikz}
\end{equation*}
```
::::

4. Explain why this quantum network implements projections on the symmetric and antisymmetric subspaces of the two qubits.

5. Two qubits are transmitted through a quantum channel which applies the same, randomly chosen, unitary operation $U$ to each of them.
    Show that the symmetric and antisymmetric subspaces are invariant under $U\otimes U$.

6. Polarised photons are transmitted through an optical fibre.
    Due to the variation of the refractive index along the fibre, the polarisation of each photon is rotated by the same unknown angle.
    This makes communication based on polarisation encoding unreliable.
    However, if you can prepare any polarisation state of the two photons then you can still use the channel to communicate without any errors.
    How can this be achieved?






## *Appendices*

### Tensor products in components

In our discussion of tensor products we have so far taken a rather abstract approach.
There are, however, situations in which we have to put numbers in, and write tensor products of vectors and matrices explicitly.
For example, here is the standard basis of two qubits written explicitly as column vectors:
$$
  \begin{aligned}
    \ket{00} &\equiv \ket{0}\otimes\ket{0}
    = \bmqty{1\\0} \otimes \bmqty{1\\0}
    = \bmqty{1\\0\\0\\0}
  \\[1em]
    \ket{01} &\equiv \ket{0}\otimes\ket{1}
    = \bmqty{1\\0} \otimes \bmqty{0\\1}
    = \bmqty{0\\1\\0\\0}
  \\[1em]
    \ket{10} &\equiv \ket{1}\otimes\ket{0}
    = \bmqty{0\\1} \otimes \bmqty{1\\0}
    = \bmqty{0\\0\\1\\0}
  \\[1em]
    \ket{11} &\equiv \ket{1}\otimes\ket{1}
    = \bmqty{0\\1} \otimes \bmqty{0\\1}
    = \bmqty{0\\0\\0\\1}
  \end{aligned}
$$
Given $\ket{a} = \alpha_0\ket{0} + \alpha_1\ket{1}$ and $\ket{b} = \beta_0\ket{0} +\beta_1\ket{1}$, we write $\ket{a}\otimes\ket{b}$ as
$$
  \begin{aligned}
    \ket{a}\otimes\ket{b}
    &= \bmqty{\alpha_0\\\alpha_1} \otimes \bmqty{\beta_0\\\beta_1}
  \\&= \bmqty{\alpha_0\bmqty{\beta_0\\\beta_1}\\\alpha_1\bmqty{\beta_0\\\beta_1}}
  \\&= \bmqty{\alpha_0\beta_0\\\alpha_0\beta_1\\\alpha_1\beta_0\\\alpha_1\beta_1}.
  \end{aligned}
$$
Note that each element of the first vector multiplies the entire second vector.
This is often the easiest way to get the tensor products in practice.

The matrix elements of the tensor product operation $A\otimes B$

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \begin{quantikz}
    \qw & \qw & \gate{A} & \qw & \qw
  \\\qw & \qw & \gate{B} & \qw & \qw
  \end{quantikz}
\end{equation*}
```

are given by
$$
  (A\otimes B)_{ik,jl} = A_{ij}B_{kl}
$$
where $ik\in\{00,01,10,11\}$ labels the rows, and $kl\in\{00,01,10,11\}$ labels columns, when forming the block matrix:^[We always use the lexicographic order $00<01<10<11$.]
$$
  \begin{aligned}
    A\otimes B
    &= \bmqty{A_{00}&A_{01}\\A_{10}&A_{11}} \otimes \bmqty{B_{00}&B_{01}\\B_{10}&B_{11}}
  \\&= \bmqty{A_{00}B&A_{01}B\\A_{10}B&A_{11}B}
  \\&=
  \left[
  \,
    \begin{array}{c|c}
      \mqty{A_{00}B_{00}&A_{00}B_{01}\\A_{00}B_{10}&A_{00}B_{11}}
      & \mqty{A_{01}B_{00}&A_{01}B_{01}\\A_{01}B_{10}&A_{01}B_{11}}
    \\\hline
    \mqty{A_{10}B_{00}&A_{10}B_{01}\\A_{10}B_{10}&A_{10}B_{11}}
      & \mqty{A_{11}B_{00}&A_{11}B_{01}\\A_{11}B_{10}&A_{11}B_{11}}
    \end{array}
  \,
  \right]
  \end{aligned}
$$

The tensor product induces a natural partition of matrices into blocks.
Multiplication of block matrices works pretty much the same as regular matrix multiplication (assuming the dimensions of the sub-matrices are appropriate), except that the entries are now matrices rather than numbers, and so may not commute.

1. Evaluate the following matrix product of $(4\times 4)$ block matrices:
    $$
      \left[
      \,
        \begin{array}{c|c}
          \id & X
        \\\hline
          Y & Z
        \end{array}
      \,
      \right]
      \left[
      \,
        \begin{array}{c|c}
          \id & Y
        \\\hline
          X & Z
        \end{array}
      \,
      \right]
    $$
    (where $X$, $Y$, and $Z$ are the Pauli matrices).

2. Using the block matrix form of $A\otimes B$ expressed in terms of $A_{ij}$ and $B_{ij}$ (as described above), explain how the following operations are performed on the block matrix:
    - transposition $(A\otimes B)^T$; partial transpositions $A^T\otimes B$ and $A\otimes B^T$;
    - trace $\tr (A\otimes B)$; partial traces $(\tr A )\otimes B$ and $A\otimes (\tr B)$.

    Consider the Hadamard transform $H\otimes H\otimes H$ on three qubits, which is described by a $(2^3\times2^3)$ matrix.
    We know that
    $$
      H = \frac{1}{\sqrt2}\bmqty{1&1\\1&-1}
    $$
    and so we can calculate that
    $$
      H\otimes H
      = \frac12
      \left[
      \,
        \begin{array}{c|c}
          \mqty{1&1\\1&-1}
          & \mqty{1&1\\1&-1}
        \\\hline
          \mqty{1&1\\1&-1}
          & \mqty{-1&-1\\-1&1}
        \end{array}
      \,
      \right]
    $$
    and thus that
    $$
      H\otimes H\otimes H
      = \frac12
      \left[
      \,
        \begin{array}{c|c|c|c}
          \mqty{1&1\\1&-1}
          & \mqty{1&1\\1&-1}
          & \mqty{1&1\\1&-1}
          & \mqty{1&1\\1&-1}
        \\\hline
          \mqty{1&1\\1&-1}
          & \mqty{-1&-1\\-1&1}
          & \mqty{1&1\\1&-1}
          & \mqty{-1&-1\\-1&1}
        \\\hline
          \mqty{1&1\\1&-1}
          & \mqty{1&1\\1&-1}
          & \mqty{-1&-1\\-1&1}
          & \mqty{-1&-1\\-1&1}
        \\\hline
          \mqty{1&1\\1&-1}
          & \mqty{-1&-1\\-1&1}
          & \mqty{-1&-1\\-1&1}
          & \mqty{1&1\\1&-1}
        \end{array}
      \,
      \right].
    $$
    The rows and columns of $H\otimes H\otimes H$ are labelled by the triples $000,001,\ldots,111$.
    Now, suppose we apply $H\otimes H\otimes H$ to the state $\ket{110}$:

``` {r,engine='tikz',engine.opts=list(template="tikz2pdf.tex")}
\begin{equation*}
  \left.
    \begin{quantikz}
      \lstick{$\ket{1}$}
      & \gate{H}
      & \qw \rstick{$\frac{\ket{0}-\ket{1}}{\sqrt2}$}
    \\\lstick{$\ket{1}$}
      & \gate{H}
      & \qw \rstick{$\frac{\ket{0}-\ket{1}}{\sqrt2}$}
    \\\lstick{$\ket{0}$}
      & \gate{H}
      & \qw \rstick{$\frac{\ket{0}+\ket{1}}{\sqrt2}$}
    \end{quantikz}
  \right\}
  =
  \frac{1}{2^{3/2}}
  \left(
    \begin{array}{r}
      \ket{000} + \ket{001} - \ket{010} - \ket{011}
    \\-\ket{100} - \ket{101} + \ket{110} + \ket{111}
    \end{array}
  \right)
\end{equation*}
```

3. The output state is a superposition of all binary strings: $\sum_x c_x\ket{x}$, with $x\in\{0,1\}^3$.
    Where in the $H^{\otimes 3}$ matrix will you find the coefficients $c_x$?

    Now, do you want to write down $H\otimes H\otimes H\otimes H$?
    I don't think so.
    This is an exponentially growing monster and you may soon run out of space if you actually do try to write it down.
    Instead, let's spot the pattern of the entries $\pm1$ in these matrices.

4. Consider the Hadamard gate matrix $H_{ab}$, where $a,b=0,1$ are the labels for the rows and the columns.
    Observe that $H_{ab}=(-1)^{ab}/\sqrt{2}$.
    (This may look like a fancy way of writing the entries of the Hadamard matrix but it will pay off in a moment).
    Using the fact that $(A\otimes B)_{ik,jl} = A_{ij}B_{kl}$, or any other method, analyse the pattern of the $\pm1$ in the tensor product of Hadamard matrices.
    What is the entry $H^{\otimes 4}_{0101,1110}$?

5. For any two binary strings $a=(a_1,\ldots, a_n)$ and $b =(b_1,\ldots , b_n)$ of the same length we can define their "scalar" product as $a\cdot b = (a_1b_1\oplus \ldots \oplus a_n b_n)$.
    Show that, up to the constant $(1/\sqrt{2})^n$, the entry $H^{\otimes n}_{a,b}$, for any $n$ and for any binary strings $a$ and $b$ of length $n$, is $(-1)^{a\cdot b}$.

6. Show that $H^{\otimes n}$ acts as
    $$
      \ket{a}
      \longmapsto
      \left(\frac{1}{\sqrt 2}\right)^n
      \sum_{b\in\{0,1\}^n} (-1)^{a\cdot b}\ket{b}
    $$

7. A quantum register of $10$ qubits holds the binary string $0110101001$.
    The Hadamard Transform is then applied to this register yielding a superposition of all binary strings of length $10$.
    What is the sign in front of the $\ket{0101010101}$ term?






### The Schmidt decomposition

An arbitrary vector in the Hilbert space $\mathcal{H}_{\mathcal{A}}\otimes \mathcal{H}_{\mathcal{B}}$ can be expanded in a product basis as
$$
  \ket{\psi}
  = \sum_{ij} c_{ij}\ket{a_i}\ket{b_j}.
$$
Moreover, for each particular joint state $\ket{\psi}$, we can find orthonormal bases, $\{\ket{\widetilde{a_i}}\}$ in $\mathcal{H}_{\mathcal{A}}$ and $\{\ket{\widetilde{b_j}}\}$ in $\mathcal{H}_{\mathcal{B}}$, such that $\ket{\psi}$ can be expressed as
$$
  \ket{\psi}
  = \sum_{i} d_{i}\ket{\tilde a_i}\ket{\tilde b_i},
$$
where the coefficients $d_i$ are non-negative numbers.
This is known as the **Schmidt decomposition** of $\ket{\psi}$.
Any bipartite state can be expressed in this form, but remember that _the bases used depend on the state being expanded_.
Indeed, given two bipartite states $\ket{\psi}$ and $\ket{\phi}$, we usually _cannot_ perform the Schmidt decomposition using the _same_ orthonormal bases in $\mathcal{H}_{\mathcal{A}}$ and $\mathcal{H}_{\mathcal{B}}$.
The number of terms in the Schmidt decomposition is, at most, the minimum of $\dim\mathcal{H}_{\mathcal{A}}$ and $\dim\mathcal{H}_{\mathcal{B}}$.

The Schmidt decomposition follows from the **singular value decomposition**  or **SVD**): _any_ $(n\times m)$ matrix  $C$ can be written as
$$
  C = UDV
$$
where $U$ and $V$ are (respectively) $(n\times n)$ and $(m\times m)$ unitary matrices and $D$ is an $(n\times m)$ diagonal matrix with real, non-negative elements in descending order $d_1\geq d_2\geq\ldots\geq d_{\min{(n,m)}}$ (and with the rest of the matrix is filled with zeros).
The elements $d_k$ are called the **singular values** of $C$.

You can visualize the SVD by thinking of $C$ as representing a linear
transformation from $m$-dimensional to $n$-dimensional Euclidean space: it maps the unit ball in the $m$-dimensional space to an ellipsoid in
the $n$-dimensional space; the singular values are the lengths of
the semi-axes of that ellipsoid; the matrices $U$ and $V$ carry
information about the locations of those axes and the vectors in
the first space which map into them.
Thus SVD tells us that the transformation $C$ is composed of rotating the unit ball (transformation $V$), stretching the axes by factors $d_k$, and then rotating the resulting ellipsoid (transformation $U$).

Using the index notation $C_{ij} = \sum_k U_{ik}d_k V_{kj}$, we can thus apply SVD to $c_{ij}$,
$$
  \begin{aligned}
    \ket{\psi}
    &= \sum_{ij} c_{ij}\ket{a_ib_j}
  \\&= \sum_{ij} \sum_k U_{ik}d_k V_{kj}\ket{a_ib_j}
  \\&= \sum_k d_k \left(\sum_i U_{ik}\ket{a_i}\right)\otimes\left(\sum_j V_{kj}\ket{b_j}\right).
  \end{aligned}
$$
The Schmidt decomposition of a separable state of the form
$\ket{a}\otimes\ket{b}$ is trivially just this state.
The Bell states $\Psi^+$ and $\Phi^+$ are already written in their Schmidt form, whereas $\Psi^-$ and $\Phi^-$ can be easily expressed in the Schmidt form.
For example, for $\ket{\Psi^-}$ we have $d_1 = d_2 = \frac{1}{\sqrt 2}$, and the Schmidt basis is $\ket{\bar a_1} =\ket{0}, \ket{\bar a_2}=\ket{1}$, $\ket{\bar b_1} = \ket{1}, \ket{\bar b_2}=-\ket{0}$.
The number of non-zero singular values of $c_{ij}$ is called the **rank** of $c_{ij}$, or the rank of the corresponding quantum state, or sometimes, the **Schmidt number**.
Clearly, all bipartite states of rank one are separable.

The Schmidt decomposition is _almost_ unique.
The ambiguity arises when we have two or more identical singular values, as, for example, in the case of the Bell states.
Then any unitary transformation of the basis vectors corresponding to a degenerate singular value, both in $\mathcal{H}_a$ and in $\mathcal{H}_b$, generates another set of basis vectors.
