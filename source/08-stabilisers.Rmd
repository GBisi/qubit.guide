# Stabilisers {#stabilisers}

> About the structure of the **Pauli group**, which is the group generated by tensor products of the Pauli matrices, including the identity.
> It has nice algebraic properties which are useful in many areas of quantum information science, in particular quantum error correction and classical simulations of some types of quantum computation.
> We will discuss how certain subgroups of the Pauli group, and in particular stabilisers and normalisers of these subgroups, slice the Pauli group into interesting cosets that have a group structure of their own.
> We will also look at the **Clifford group**, which is a set of unitary operators that preserve the Pauli group under conjugation and describes the easy part of quantum computation.

We have already seen the (single-qubit) Pauli matrices, along with a brief look into their algebraic structure, in Section \@ref(pauli-matrices-algebraically).

$$
  \id = \begin{bmatrix}1&0\\0&1\end{bmatrix}
  \qquad
  X = \begin{bmatrix}0&1\\1&0\end{bmatrix}
  \qquad
  Y = \begin{bmatrix}0&-i\\i&0\end{bmatrix}
  \qquad
  Z = \begin{bmatrix}1&0\\0&-1\end{bmatrix}
$$

Recall that these matrices span the entire space of $(2\times2)$ complex matrices, square to the identity (and thus can only have eigenvalues in the set $\{+1,-1\}$), and are both Hermitian and unitary.
As such, they can represent both observables *and* unitary evolutions.
Any two given Pauli matrices either commute or anticommute.

As one final reminder, we often refer to the Pauli matrices as "matrices", but they are defined as operators by the commutations relations, without reference to any particular basis.
That is, the Pauli operators $X$, $Y$, and $Z$ are defined exactly by the relations
$$
  \begin{gathered}
    X^2 = Y^2 = Z^2 = \id
  \\XY=iZ \qquad YZ=iX \qquad ZX=iY
  \\YX=-iZ \qquad ZY=-iX \qquad XZ=-iY.
  \end{gathered}
$$


## Pauli and his group

When we multiply the four Pauli matrices with one another we get Pauli matrices in return, but with possible phase factors $\pm1$ and $\pm i$ (e.g. $XY=iZ$).
Once we include these phase factors, ensuring that we have a set that is closed under matrix multiplication, we obtain the **single qubit Pauli group**, which we denote by $\mathcal{P}_1$.

In order to characterise a group, we can simply list all its elements and define the group operation on each possible pair, but it is usually more efficient to use the notion of **group generators**.^[Note how similar this is to the definition of a basis for a vector space.]
Given a group $G$, these are elements $g_1,\ldots,g_n$ of the group that are **independent** (we cannot write any one of them as a product of some of the others) and such that every element of $G$ can be written as a product of (possibly repeated) elements of $\{g_1,\ldots,g_n\}$.
If $G$ is generated by $g_1,\ldots,g_n$, then we write $G=\langle g_1,\ldots,g_n\rangle$.

::: {.idea latex=""}
The **single-qubit Pauli group** $\mathcal{P}_1$ is defined by
$$
  \begin{aligned}
    \mathcal{P}_1
    &\coloneqq \langle X,Y,Z\rangle
  \\&= \{\pm\id, \pm i\id, \pm X, \pm iX, \pm Y, \pm iY, \pm Z, \pm iZ\}.
  \end{aligned}
$$

The **$n$-qubit Pauli group** $\mathcal{P}_n$ is defined to consist of all $n$-fold tensor products of Pauli matrices, with possible global phase factors $\pm1$ and $\pm i$, i.e.
$$
  \mathcal{P}_n
  \coloneqq \{P_1\otimes\ldots\otimes P_n \mid P_1,\ldots,P_n\in\mathcal{P}_1\}.
$$
This group has $4^{n+1}$ elements: $4\times4^n$, since we have to account for the possible global phase factors (which usually aren't very important for practical applications, but are necessary in order to have a well defined group).^[As a small mathematical aside, we could use some group theory here: $\mathcal{P}_n$ has two trivial (multiplicative) subgroups, namely $Z_2=\{\pm1\}$ and $Z_4=\{\pm1,\pm i\}$; the quotient group $\mathcal{P}_n/Z_4$ is exactly the $n$-qubit Pauli group but with the phases ignored.]
:::

Some researchers prefer to think of the (single-qubit) Pauli group as the group generated only by $X$ and $Z$ (leaving out $Y$), which then only has 8 elements: $\pm1$, $\pm X$, $\pm Z$, and $\pm iY$.
We do **not** follow this convention.

::: {.technical title="Central products" latex=""}
One abstract way of defining the Pauli group, without having to make any reference to matrices (and thus to bases), or even to operators, is using the notion of a [**central product**](https://en.wikipedia.org/wiki/Central_product).
This is a way of combining two smaller group into one large group, but "respecting" the commutative parts of each, which means that it arises as a quotient of the [**direct product**](https://en.wikipedia.org/wiki/Direct_product_of_groups) (which is somehow the most blunt way of combining together two groups).

The **cyclic group of order 4** is the abstract manifestation of something maybe more familiar: the additive group of integers modulo 4.
That is, the numbers $0$, $1$, $2$, and $3$ form a group under addition, but where we take the addition to be "remainder 4", so that e.g. $3+2=1$.
In abstract algebra, this group is denoted by $C_4$.

The **dihedral group of order 8** (sometimes, very confusingly, also referred to as being of order *4*) arises as the symmetry group of a square: we can rotate a square by $90^\circ$, or reflect it along either of the axis joining any two diagonally opposite corners, or reflect it along either of the axis joining the midpoints of any two opposite sides --- doing any of these actions leaves the square looking exactly how it started.
But some of these actions describe the same thing!
For example, reflecting through the vertical axis and then the horizontal axis is the same as rotating by $180^\circ$ (try visualising this by flipping and rotating your hand!), which is a specific example of the more general fact (which we briefly touched upon in Section @\ref(composition-of-rotations)) that the composition of two reflections is the same as a rotation through twice the angle between the two axes.
In abstract algebra, this group is denoted by $D_8$ (though in geometry it is often written as $D_4$ instead).

The relevance to the Pauli group is this: the central product of $C_4$ and $D_8$ is exactly $\mathcal{P}_1$.
:::

If it is clear that we are working with *tensor products* of Pauli matrices, then we often (as per usual) omit the tensor product symbol, writing e.g. $XY\id Z$ instead of $X\otimes Y\otimes\id\otimes Z$ when talking about $\mathcal{P}_4$.
Note however that we only do this when it is obvious what we mean: this is very different from the product $XY\id Z=i\id$ inside $\mathcal{P}_1$!

Let's now talk a little bit about the algebraic structure of $\mathcal{P}_n$.
Multiplying together elements is fairly simple: since they are tensor products, we multiply them component-wise, but just remembering to pay attention to the global phase.
For example, we can multiply $ZXX\id$ and $XXYY$ in $\mathcal{P}_4$ as follows:
$$
  \begin{aligned}
    (ZXX\id)\cdot(XXYY)
    &= (ZX)(XX)(XY)(\id Y)
  \\&= (iY)(\id)(iZ)(Y)
  \\&= -Y\id ZY.
  \end{aligned}
$$
Next, any pair of elements in $\mathcal{P}_n$ either commute or anticommute: given $P=P_1\ldots P_n$ and $Q=Q_1\ldots Q_n$, we notice that they commute exactly whenever the number of *anticommuting* components (indices $j$ such that $P_jQ_j=-Q_jP_j$) is even, since then the minus signs cancel out.
In other words, $PQ=(-1)^J QP$, where $J=|\{j\text{ such that }P_jQ_j=-Q_jP_j\}|$.
For example, if we consider two elements of $\mathcal{P}_9$ and write $\checkmark$ to mean that two components commute, and $!$ to mean that they don't, we can then just count to see if there are an odd or even number of $!$ overall, like so:
$$
  \begin{array}{ccccccccc}
    Z&X&Y&X&Y&Z&X&X&Y
  \\Z&X&\id&Z&Z&X&\id&Y&Z
  \\\hline
    \checkmark&\checkmark&\checkmark&!&!&!&\checkmark&!&!
  \end{array}
$$
and since there are 5 anticommuting components, we see that $ZXYXYZXXY$ and $ZX\id ZZX\id YZ$ anticommute.

Finally, the square of any element in $\mathcal{P}_n$ is $\pm\id$.
Indeed, all the elements in the Pauli group are unitary, and each one is either Hermitian (overall phase $\pm1$ and squares to $\id$) or anti-Hermitian (overall phase $\pm i$ and squares to $-\id$).
As per usual, we are only really interested in working with the Hermitian elements, and we refer to *these* as the Pauli operators.

::: {.idea latex=""}
An **$n$-qubit Pauli operator** is a Hermitian element of the $n$-qubit Pauli group $\mathcal{P}_n$.
:::

Since the Pauli operators are self-inverse (they square to the identity), their eigenvalues can only be $\pm1$.
Furthermore, these eigenvalues must be of the same degeneracy, and the eigenspaces corresponding to each eigenvalue are of the same dimension, as we can see by taking the trace of a Pauli operator:
$$
  \tr(P_1\otimes P_2\otimes\ldots\otimes P_n) = (\tr P_1)(\tr P_2)\ldots(\tr P_n)
$$
which is zero, except in the trivial case where $P_1=P_2=\ldots=P_n=\id$.
Last but not least, the $n$-qubit Pauli group spans the space of $(2^n\times 2^n)$ complex matrices.


## Pauli and his stabilisers {#pauli-and-his-stabilisers}

The stabiliser (or stabilizer, if you like) formalism is an elegant technique that is often used to describe vectors and subspaces.
Suppose you want to specify a particular vector in a Hilbert space.
The most conventional way to do this would be to pick a basis and then list the coordinate components of the vector.
But we could instead list a set of operators that leave this vector invariant.
More generally, we can define a vector subspace (rather than just a single vector, which corresponds to a 1-dimensional subspace: its span) by giving a list of operators that fix this subspace.
Such operators are called **stabilisers**.

::: {.idea latex=""}
We say that an operator $S$ **stabilises** a (non-zero) state $\ket{\psi}$ if $S\ket{\psi}=\ket{\psi}$.
We say that $S$ stabilises a subspace $V$ if $S$ stabilises every state in $V$.
Then we call $\ket{\psi}$ (or $V$) the **stabiliser state** (or **stabiliser subspace**).
:::

In other words, an operator $S$ stabilises a state $\ket{\psi}$ (or the state is fixed by the operator) if $\ket{\psi}$ is an eigenstate of $S$ with eigenvalue $1$.
It is very important to note that here we *have* to pay attention to the global phase factor: if $S\ket{\psi}=-\ket{\psi}$ then we do *not* say that $S$ stabilises $\ket{\psi}$, even though $\ket{\psi}$ and $-\ket{\psi}$ describe the same quantum state.

For example, we can look at states stabilised by the Pauli operators with factors $\pm1$:
$$
  \begin{aligned}
    Z\text{ stabilises }\ket{0}
    &\qquad-Z\text{ stabilises }\ket{1}
  \\Y\text{ stabilises }\ket{i}
    &\qquad-Y\text{ stabilises }\ket{-i}
  \\X\text{ stabilises }\ket{+}
    &\qquad-X\text{ stabilises }\ket{-}
  \end{aligned}
$$
where $\ket{\pm i}=\frac{1}{\sqrt{2}}(\ket{0}+i\ket{1})$ and $\ket{\pm}=\frac{1}{\sqrt{2}}(\ket{0}\pm\ket{1})$.

On the Bloch sphere, these single-qubit stabiliser states lie at the intersection of the three axes with the surface of the sphere.

```{r,engine='tikz',fig.width=3}
\newcommand{\ket}[1]{|#1\rangle}
\begin{tikzpicture} [scale=1.7]
  \draw (0,0) circle(1);
  \draw plot[domain=pi:2*pi] ({cos(\x r)},{.3*sin(\x r)});
  \draw[dashed] plot[domain=0:pi] ({cos(\x r)},{.3*sin(\x r)});
  \draw[-latex] (0,0) to (0,1)node[above] {$\ket{0}$};
  \draw[->] (0,0) to (0,-1) node[below] {$\ket{1}$};
  \draw[->] (0,0) to (1,0) node[right] {$\ket{+i}$};
  \draw[->] (0,0) to (-1,0)  node[left] {$\ket{-i}$};
  \draw[->] (0,0) to ({cos(45 r)},{0.3*sin(45 r)}) node[above] {$\ket{-}$};
  \draw[->] (0,0) to ({-cos(45 r)},{-0.3*sin(45 r)}) node[below] {$\ket{+}$};
\end{tikzpicture}
```

We can also say something about the remaining two elements of the single-qubit Pauli group: $\id$ stabilises everything, and $-\id$ stabilises nothing (except for the zero state, which we explicitly ignore).
More generally, if $S$ stabilises something then $-S$ cannot stabilise the same thing.

The set of all stabilisers of a given state or given subspace form a group: if $S\ket{\psi}=\ket{\psi}$, then multiplying both sides by $S^{-1}$ shows that the inverse of a stabiliser is again a stabiliser; the composition of two stabilisers is again a stabiliser, since $(ST)\ket{\psi}=S(T\ket{\psi})=S\ket{\psi}=\ket{\psi}$; and as we have just said, the identity is always a stabiliser.
This group is called the **stabiliser group** of the given state or subspace.

Using this language, we can rephrase the previous example by saying that the stabiliser group of the state $\ket{1}$ is $\{\id,Z\}=\langle Z\rangle$, the stabiliser group of the state $\ket{0}$ is $\{\id,-Z\}=\langle -Z\rangle$, the stabiliser group of the state $\ket{+}$ is $\{\id,X\}=\langle X\rangle$, and so on.
If we take the tensor product of a two states, with stabiliser groups $\mathcal{A}$ and $\mathcal{B}$ (respectively), then the resulting tensor product state has stabiliser group given by the cartesian product $\mathcal{A}\times\mathcal{B}$.
For example, the state $\ket{1}\ket{+}$ is stabilised by the group
$$
  \begin{aligned}
    \{\id,Z\}\times\{\id,X\}
    &= \{\id\id,\id X,Z\id,ZX\}
  \\&= \langle Z\id,\id X\rangle.
  \end{aligned}
$$
As for the state $\ket{0}^{\otimes n}$, this is stabilised by the group generated by the $n$ elements $Z\id\id\ldots\id$, $\id Z\id\ldots\id$, ..., $\id\id\ldots,Z$, so we often simply stack the generators and write such generating sets as $(n\times n)$ matrices, labelling the left-hand side with the relevant signs:
$$
  \ket{0000}
  \longleftrightarrow
  \begin{array}{c|cccc|}
    +&Z&\id&\id&\id
  \\+&\id&Z&\id&\id
  \\+&\id&\id&Z&\id
  \\+&\id&\id&\id&Z
  \end{array}
$$
and we can see that the signs determine the bit value in the computational basis state, if we look at the generators of the stabiliser groups for some other states:
$$
  \ket{0001}
  \longleftrightarrow
  \begin{array}{c|cccc|}
    +&Z&\id&\id&\id
  \\+&\id&Z&\id&\id
  \\+&\id&\id&Z&\id
  \\-&\id&\id&\id&Z
  \end{array}
  \qquad
  \ket{0101}
  \longleftrightarrow
  \begin{array}{c|cccc|}
    +&Z&\id&\id&\id
  \\-&\id&Z&\id&\id
  \\+&\id&\id&Z&\id
  \\-&\id&\id&\id&Z
  \end{array}
$$

For our purposes, we are only really interested in stabilisers that are also elements of the $n$-qubit Pauli group $\mathcal{P}_n$, and we shall soon see that these form an *abelian* group.
It turns out that such stabilisers can describe highly entangled states.
In particular, the four Bell states (which we first talked about in Section \@ref(bell-states)) can be defined rather succinctly by their stabiliser groups:

| Bell state | Stabiliser group |
| :--------- | :--------------- |
| $\Phi^+=\ket{00}+\ket{11}$ | $\langle XX,ZZ\rangle$ |
| $\Psi^+=\ket{01}+\ket{10}$ | $\langle XX,-ZZ\rangle$ |
| $\Phi^-=\ket{00}-\ket{11}$ | $\langle -XX,ZZ\rangle$ |
| $\Psi^-=\ket{01}-\ket{10}$ | $\langle -XX,-ZZ\rangle$ |

Not only this, but some vector spaces are also rather easily defined: the subspace of the three-qubit state space spanned by $\ket{000}$ and $\ket{111}$ is stabilised by
$$
  \{\id\id\id,ZZ\id,Z\id Z,\id ZZ\} = \langle ZZ\id,\id ZZ\rangle.
$$

Right now, it might seem more complicated to use stabilisers to define vectors or subspaces, but when we start looking at states with a larger and larger number of components we will see how this approach ends up being very tidy indeed!
It is not be true that the stabiliser description of states and subspaces will *always* be the most concise, but it is true in a lot of cases that are of interest to us.

Returning to our claim that stabiliser groups that are subgroups of $\mathcal{P}_n$ are abelian, let us start with a definition, and then justify it afterwards.

::: {.idea latex=""}
An **$n$-qubit Pauli stabiliser group** is any subgroup of $\mathcal{P}_n$ that is abelian and does not contain $-\id$.
Its elements are called **Pauli stabilisers**.
:::

Recall that, in order for the subspace $V_S$ stabilised by some group $S$ to be non-trivial, we need $-\id\not\in S$.
Given that all Pauli operators square to the identity, and all pairs of Pauli operators either commute or anticommute, this implies that if we want some Pauli operators to stabilise anything then they must *commute*.
Indeed, if $S_1$ and $S_2$ are two Pauli operators that anticommute, and $\ket{\psi}$ is any vector stabilised by both of them, then
$$
  \begin{aligned}
    \ket{\psi}
    &= S_1S_2\ket{\psi}
  \\&= -S_2S_1\ket{\psi}
  \\&= -\ket{\psi}
  \end{aligned}
$$
which means that $\ket{\psi}=0$.
But saying that we are looking at a stabiliser group consisting of Pauli stabilisers that all commute with one another (as opposed to anticommuting) is exactly saying that we have an abelian subgroup of $\mathcal{P}_n$; if we want it to be non-trivial, then we need it to not contain $-\id$.
Conversely, if we pick any abelian subgroup of $\mathcal{P}_n$ that does not contain $-\id$, this stabilises *some* subspace $V_S$.

The size of any Pauli stabiliser $\mathcal{S}$ is $|\mathcal{S}|=2^r$, where $r$ is some positive integer, since we can always find some choice of generators $G_1,\ldots,G_r$, and then any operator $S\in\mathcal{S}$ can be written as^[An interesting small exercise here is to explain why the product of any *independent* Pauli stabilisers cannot be equal to the identity.]
$$
  S = G_1^{\epsilon_1}G_2^{\epsilon_2}\ldots G_r^{\epsilon_r}
$$
where $r_i\in\{0,1\}$.
But given any stabiliser group, we can always express its elements using many different sets of generators; a specific choice of $r$ independent generators of a Pauli stabiliser $\mathcal{S}$ of size $2^r$ is called a **presentation**.
In order to choose a presentation from the set of elements of $\mathcal{S}$, we have to start by picking any non-identity element, of which there are $2^r-1$.
Inductively then, we pick the next generator by picking any element which is not in the subgroup generated by the previously selected generators, which means that there are
$$
  (2^r-1)(2^r-2)(2^r-2^2)\ldots(2^r-2^{r-1})
$$
possible generating sets of $\mathcal{S}$.
But these are *ordered* sets (i.e. we are keeping track of the order in which we pick the elements, so $G_1,G_2,\ldots$ is a "different" choice than $G_2,G_1,\ldots$), so if we want to know the number of presentations then we can simply divide the expression above by $r^!$.

For example, the Bell state $\Phi^+=\ket{00}+\ket{11}$ is stabilised by the group $\{\id\id,XX,-YY,ZZ\}$.
This stabiliser group has $(2^2-1)(2^2-2)/2!=3$ presentations, namely $\langle XX,ZZ\rangle$, $\langle -YY,XX\rangle$, and $\langle ZZ,-YY\rangle$.

So now we know the size of a Pauli stabiliser, but what can we say about the dimension of the subspace that it stabilises?
If $|\mathcal{S}|=2^r$ then the corresponding stabiliser subspace $V_S$ has dimension $2^{n-r}$ (where $n$ is the number of qubits, i.e. such that $\mathcal{S}\subseteq\mathcal{P}_n$).
To see this, we can look at the projector $P_S$ onto $V_S$, since once we have a projector onto any subspace we know that the dimension of that subspace is exactly the trace of the projector (we can prove this by thinking about the matrix of the projector in the diagonal form).
In our case (using the result of Exercise \@ref(stabilisers-and-projectors)) we calculate that
$$
  \begin{aligned}
    \tr P_S
    &= \tr\frac{1}{2^r}(S_1+S_2+\ldots+S_{2^r})
  \\&= \frac{1}{2^r}(\tr\id)
  \\&= 2^{n-r}
  \end{aligned}
$$
since any non-identity element of the stabiliser group has trace equal to zero, and $\tr\id^{\otimes n}=2^n$, whence $\dim V_s=2^{n-r}$.
If $r=n$ then the stabilised subspace is $1$-dimensional, and so we have stabiliser states.

There is a more geometric way of understanding why powers of 2 keep on turning up in these calculations.
Given independent Pauli generators, it is convenient to think about the state or subspace that they stabilise as being the result of repeatedly bisecting the Hilbert space.
Let $G_1,\ldots,G_r$ be a presentation of a Pauli stabiliser $\mathcal{S}$.
For each operator $G_i$, half its eigenvalues are $+1$ and another half are $-1$, so each $G_i$ bisects the $2^n$-dimensional Hilbert space of $n$ qubits into two eigenspaces of equal size.
So $G_1$ gives two $2^{n-1}$-dimensional subspaces: one for the $+1$ eigenvalue and one for the $-1$ eigenvalue.
Forgetting about the $-1$ part and just focusing on the $+1$ part, $G_2$ then splits this $2^{n-1}$-dimensional subspace into two $2^{n-2}$-dimensional subspaces, since it is independent from $G_1$ (as we justify in Exercise \@ref(stabilisers-and-projectors)).
Repeating this procedure, forgetting about the $-1$ subspace each time, leads us to consider the simultaneous $+1$ eigenspace of $G_1,\ldots,G_r$, where each time we pass from $\{G_1,G_2,\ldots,G_i\}$ to $\{G_1,G_2,\ldots,G_i,G_{i+1}\}$ we bisect the subspace into two equal parts once more, eventually ending with the $2^{n-2}$-dimensional subspace $V_S$, as above.
We can show this pictorially, as in Figure \@ref(fig:stabiliser-bisection).


(ref:stabiliser-bisection-caption) The stabiliser group $\{ZZ\id,\id ZZ\}$ bisects the Hilbert space of three qubits into four equal parts, and gives the stabilised subspace $V_S$ which is spanned by $\ket{000}$ and $\ket{111}$. Think of the labels $ZZ\id$ and $\id ZZ$ as the $x$- and $y$-axes, and the sign labels on each square as $(x,y)$-coordinates. So the two squares on the left together make the $+1$ eigenspace of $\id ZZ$, and the two squares on the top make the $+1$ eigenspace of $ZZ\id$.

```{r stabiliser-bisection,engine='tikz',fig.cap='(ref:stabiliser-bisection-caption)',fig.width=3}
\definecolor{primary}{RGB}{177,98,78}
\definecolor{secondary}{RGB}{91,132,177}
\newcommand{\id}{\mathbf{1}}
\newcommand{\ket}[1]{|#1\rangle}
\begin{tikzpicture}
  \draw (0,0) rectangle (4,4);
  \node[] (c0) at (1,2.8) {{\color{primary}$+$}{\color{secondary}$+$}};
  \node[] (c1) at (3,2.8) {{\color{primary}$-$}{\color{secondary}$+$}};
  \node[] (c2) at (3,1.2) {{\color{primary}$-$}{\color{secondary}$-$}};
  \node[] (c3) at (1,1.2) {{\color{primary}$+$}{\color{secondary}$-$}};
  \node[above,secondary] (S1) at (2,4.5) {$ZZ\id$};
  \node[right,primary] (S2) at (4.5,2) {$\id ZZ$};
  \node[primary] (S1+) at (1,4.5) {$+1$};
  \node[primary] (S1-) at (3,4.5) {$-1$};
  \node[secondary] (S2+) at (4.5,3) {$+1$};
  \node[secondary] (S2-) at (4.5,1) {$-1$};
  \node[anchor=north west] (A) at (0,4) {$\substack{\ket{000}\\ \ket{111}}$};
  \node[anchor=north east] (B) at (4,4) {$\substack{\ket{100}\\ \ket{011}}$};
  \node[anchor=south east] (C) at (4,0) {$\substack{\ket{010}\\ \ket{101}}$};
  \node[anchor=south west] (D) at (0,0) {$\substack{\ket{001}\\ \ket{110}}$};
  \draw (2,0) -- (2,4.5);
  \draw (0,2) -- (4.5,2);
\end{tikzpicture}
```


## Single stabiliser states

Given $n$ independent generators of a stabiliser group $\mathcal{S}$ on a Hilbert space of $n$-qubits, we end up specifying a $1$-dimensional subspace, meaning it is spanned by a single basis vector, namely the stabiliser state.
We have already talked about the single-qubit stabiliser states determined by all possible stabilisers in $\mathcal{P}_1$, namely $\ket{0}$ and $\ket{1}$ for $\langle \pm Z\rangle$, $\ket{\pm}$ for $\langle \pm X\rangle$, and $\ket{\pm i}$ for $\langle \pm Y\rangle$.
We have also mentioned some of the two-qubit stabilisers states, some of which are highly entangled, such as the Bell states, and some of which are separable, such as the computational basis states (whose stabilisers groups we described by block matrices with $Z$ on the diagonal, $\id$ everywhere else, and signs labelling each row depending on the binary description of the state).

Here's another two-qubit example: that of the maximally entangled state $\ket{00}+\ket{11}$.
This is stabilised by $\langle XX,ZZ\rangle$, but let's explain how we can see this.
If we look first at the operator $XX$, we see that it splits the $4$-dimensional Hilbert space into two $2$-dimensional subspaces, corresponding to eigenvalues $\pm1$; by definition, it stabilises the one corresponding to eigenvalue $+1$, which is spanned by $\ket{00}+\ket{11}$ and $\ket{01}+\ket{10}$.
Now the operator $ZZ$ also splits the $4$-dimensional Hilbert space into two $2$-dimensional subspaces, again corresponding to eigenvalues $\pm1$; it stabilises the one corresponding to eigenvalue $+1$, which is spanned by $\ket{00}+\ket{11}$ and $\ket{00}-\ket{11}$.
Note that $\ket{01}+\ket{10}$ is in the $-1$ eigenspace of $ZZ$, even though it is in the $+1$ eigenspace of $XX$ (and vice versa for $\ket{00}-\ket{11}$).
So the simultaneous $+1$ eigenspace of $XX$ and $ZZ$ is exactly the state $\ket{00}+\ket{11}$.
$$
  \begin{aligned}
    \ket{00}+\ket{11}
    \longleftrightarrow
    \begin{array}{c|cc|}
      +&X&X
    \\+&Z&Z
    \end{array}
    \quad&\quad
    \ket{00}-\ket{11}
    \longleftrightarrow
    \begin{array}{c|cc|}
      -&X&X
    \\+&Z&Z
    \end{array}
  \\\ket{01}+\ket{10}
    \longleftrightarrow
    \begin{array}{c|cc|}
      +&X&X
    \\-&Z&Z
    \end{array}
    \quad&\quad
    \ket{01}-\ket{10}
    \longleftrightarrow
    \begin{array}{c|cc|}
      -&X&X
    \\-&Z&Z
    \end{array}
  \end{aligned}
$$

As we have already mentioned when discussing presentations of a stabiliser group, there can be multiple different generating sets, which corresponds to the fact that there are multiple different ways of bisecting the Hilbert space.
For example, the stabiliser state $\ket{00}+\ket{11}$ is completely specified by $\langle XX,ZZ\rangle$, as shown above, but also by $\langle XX,-YY\rangle$ or $\langle -YY,ZZ\rangle$.
But, as we should expect, these three generating sets all generate the same group, namely $\mathcal{S}=\{\id\id,XX,-YY,ZZ\}$.

How many $n$-qubit stabiliser states do we have?
The answer is
$$
  2^n\prod_{k=0}^{n-1}(2^{n-k}+1)
$$
as we can show with a counting argument: we will count the number of generating sets with $n$ generators (since this is exactly the right number of generators to specify a $1$-dimensional stabiliser subspace) and then divide by the number of presentations for any given stabiliser.^[This is a common technique in combinatorial arguments: first *over*count, and then fix your answer by accounting for this.]
There are $4^{n-1}$ choices for the first generator $G_1$ (ignoring overall sign), since it can be any $n$-fold tensor product of the four Pauli matrices, excluding the identity $\id\id\id\id$.
For the second generator $G_2$, we have $(4^n/2)-2$ possibilities, since it must commute with the first generator (and we know that exactly half of the operators commute with any given operator, as shown in Exercise \@ref(half-commuting), whence $4^n/2$) and it cannot be $\id\id\id\id$ or $G_1$ (whence $-2$).
Similarly, $G_3$ must commute with both $G_1$ and $G_2$, but it cannot be in the group generated by them, so there are $(4^n/4)-4$ possible choices, and so on.
This means that we have
$$
  2^n(4^n-1)\left(\frac{4^n}{2}-2\right)\left(\frac{4^n}{4}-4\right)\ldots\left(\frac{4^n}{2^{n-1}}-2^{n-1}\right)
$$
possible generating sets in total.
Now we need to divide by the number of presentations, but we have already calculated this in Section \@ref(pauli-and-his-stabilisers): it's exactly
$$
  (2^n-1)(2^n-2)(2^n-2^2)\ldots(2^n-2^{n-1}).
$$
It is a fun algebra exercise to show that this division indeed gives the number we claimed.

As we will see, stabiliser states are ubiquitous in quantum information theory due to their versatility and relative simplicity.
They play a crucial role in areas such as quantum error correction, measurement-based quantum computation, and entanglement classification.


## Measuring Pauli stabilisers {#measuring-pauli-stabilisers}

How do we bisect Hilbert spaces in practice?
By measuring stabilisers.

Let's start by measuring any single-qubit observable that squares to the identity.
The corresponding operator $P$ with eigenvalues $\pm1$ is both Hermitian and unitary, and can thus represent both an observable and a quantum gate.
If we prepare a qubit in some state $\ket{\psi}$ and then wish to perform a measurement that will give us a result of $\pm1$ and leave the qubit in a post-measurement state, namely the corresponding eigenvector, then we can use the following circuit (where $\propto$ denotes that two states are multiples of one another).

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=4}
\newcommand{\id}{\mathbf{1}}
\begin{quantikz}
  \lstick{$\ket{0}$}
  &\gate{H}
  &\ctrl{1}
  &\gate{H}
  &\meterD{}
\\\lstick{$\ket{\psi}$}
  &\qw
  &\gate{P}
  &\qw
  &\qw\rstick{$\propto\id\pm P\ket{\psi}$}
\end{quantikz}
```

This construction requires an auxiliary qubit (in the top register), two Hadamard gates, and the tacit assumption that we can construct a controlled-$P$ operator.
Stepping through the execution of this circuit, we get
$$
  \begin{aligned}
    \ket{0}\ket{\psi}
    &\xmapsto{H\otimes\id}
      \frac{1}{\sqrt{2}}(\ket{0}+\ket{1})\ket{\psi}
  \\&\xmapsto{\texttt{c-}P}
      \frac{1}{\sqrt{2}}\ket{0}\ket{\psi} + \frac{1}{\sqrt{2}}\ket{1}P\ket{\psi}
  \\&\xmapsto{H\otimes\id}
      \ket{0}\frac{1}{2}(\id+P)\ket{\psi} + \ket{1}\frac{1}{2}(\id-P)\ket{\psi}.
  \end{aligned}
$$
The final state of the two qubits indicates that, when the auxiliary (top) qubit is found in state $\ket{0}$ then we projected the state $\ket{\psi}$ onto the $+1$ eigenspace of $P$ (via the projector $\frac{1}{2}(\id+P)$), and when it is found in state $\ket{1}$ then we projected $\ket{\psi}$ onto the $-1$ eigenspace (via the projector $\frac{1}{2}(\id-P)$).
In particular, the $X$, $Y$, and $Z$ observables can be measured using controlled-$X$, controlled-$Y$, and controlled-$Z$ gates (respectively).
This pattern can easily be extended to an $n$-qubit Pauli operator.
For example, for $n=3$, a generic circuit that implements a projective measurement onto the $\pm1$ eigenspaces of $S=P_1\otimes P_2\otimes P_3$ has the form

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=4}
\begin{quantikz}
  \lstick{$\ket{0}$}
  &\gate{H}
  &\ctrl{1}
  &\ctrl{2}
  &\ctrl{3}
  &\gate{H}
  &\meterD{}
\\\lstick[wires=3]{$\ket{\psi}$}
  &\qw
  &\gate{P_1}
  &\qw
  &\qw
  &\qw
  &\qw
\\[-1.5 em] \qw
  &\qw
  &\qw
  &\gate{P_2}
  &\qw
  &\qw
  &\qw
\\[-1.5 em] \qw
  &\qw
  &\qw
  &\qw
  &\gate{P_3}
  &\qw
  &\qw
\end{quantikz}
```

and is usually drawn more compactly as

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=4}
\begin{quantikz}
  \lstick{$\ket{0}$}
  &\gate{H}
  &\ctrl{3}
  &\gate{H}
  &\meterD{}
\\\lstick[wires=3]{$\ket{\psi}$}
  &\qw
  &\gate{P_{1}}
  &\qw
  &\qw
\\[-.8 em] \qw
  &\qw
  &\gate{P_{2}}
  &\qw
  &\qw
\\[-.8 em] \qw
  &\qw
  &\gate{P_{3}}
  &\qw
  &\qw
\end{quantikz}
```

In this way, we can measure stabilisers and project onto the subspaces that they stabilise.
For example, take the stabiliser group $\mathcal{S}=\langle XX,ZZ\rangle$, and consider the circuit below:

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=4}
\begin{quantikz}
  \lstick{$\ket{0}$}
  &\gate{H}
  &\ctrl{3}
  &\qw
  &\gate{H}
  &\meterD{}
\\\lstick{$\ket{0}$}
  &\gate{H}
  &\qw
  &\ctrl{2}
  &\gate{H}
  &\meterD{}
\\\lstick[wires=2]{$\ket{\psi}$}
  &\qw
  &\gate{X}
  &\gate{Z}
  &\qw
  &\qw
\\[-.8 em] \qw
  &\qw
  &\gate{X}
  &\gate{Z}
  &\qw
  &\qw
\end{quantikz}
```

The registered bit values from the first and second (counting from the top) auxiliary qubits tell us how we bisect the Hilbert space with $XX$ and $ZZ$ (respectively), recalling that a bit value of $0$ corresponds to the $+1$ Pauli eigenvalue, and a bit value of $1$ to the $-1$ eigenvalue.
The first measurement can project $\ket{\psi}$ either onto $\frac{1}{2}(\id+XX)$ (in which case the first auxiliary qubit will show $0$, corresponding to the eigenvalue $+1$, and the subspace spanned by $\ket{00}+\ket{11}$ and $\ket{01}+\ket{10}$) or onto $\frac{1}{2}(\id-XX)$ (in which case the first auxiliary qubit will show $1$, corresponding to the eigenvalue $-1$, and the subspace spanned by $\ket{00}-\ket{11}$ and $\ket{01}-\ket{10}$).
The second measurement can further project the resulting post-measurement state of the two qubits either onto $\frac{1}{2}(\id+ZZ)$ (in which case the second auxiliary qubit will show $0$, corresponding to the eigenvalue $+1$, and the subspace spanned by $\ket{00}+\ket{11}$ and $\ket{00}-\ket{11}$) or onto $\frac{1}{2}(\id-ZZ)$ (in which case the second auxiliary qubit will show $1$, corresponding to the eigenvalue $-1$, and the subspace spanned by $\ket{01}+\ket{10}$ and $\ket{01}-\ket{10}$).
So if both auxiliary qubits show bit value outcome $0$ (corresponding to the "Pauli" outcome $(+1,+1)$, describing the eigenvalues), then we have successfully projected onto the state stabilised by $XX$ and $ZZ$, which is exactly $\ket{00}+\ket{11}$.
More generally, in "Pauli notation", the outcome $(\pm1,\pm1)$ corresponds to the projection onto the stabiliser state stabilised by $\langle\pm XX,\pm ZZ\rangle$.

Needless to say, we do not have any control over the actual outcomes of the measurement, but we do now know *which* post-measurement state we have generated.
This means that we can use the circuit to prepare a desired state by applying an appropriate unitary operation to the final state.
For example, if we want to generate the state $\ket{00}+\ket{11}$ but actually end up with the state $\ket{00}-\ket{11}$, then we can simply apply the $Z$ operation to any of the two qubits to get the desired result.
This generic method is now the only way of constructing projective measurements of Pauli observables, however --- see Exercise @\ref(equivalent-projective-pauli-measurements)















































## *Remarks and exercises* {#remarks-and-exercises-stabilisers}

### Half commuting {#half-commuting}

Any Pauli matrix that is not the identity commutes with exactly half of all the Pauli matrices: namely, with the identity and with itself.
For example, $X$ commutes with $\id$ and $X$, and anticommutes with $Y$ and $Z$.

Extend this observation to any non-identity element in $\mathcal{P}_n$.
In other words, show that, for any $P\in\mathcal{P}_n\setminus\{\id^{\otimes n}\}$, exactly half of the elements in $\mathcal{P}_n$ commute with $P$.


### Only one out of four stabilisers

Explain why, if $S$ is an element of some stabiliser group, then none of $-S$, $iS$, or $-S$ are in the same stabiliser group.


### Stabilisers and projectors {#stabilisers-and-projectors}

Let $\mathcal{S}$ be a Pauli stabiliser group, with generators $G_1,\ldots,G_r$.

1. Show that $\frac{1}{2}(\id\pm G_j)$ is the projector onto the $\pm1$ eigenspace of $G_j$ for any $j=1,\ldots,r$.
2. Show that the projector
    $$
      P = \frac{1}{2}(\id+G_1)\frac{1}{2}(\id+G_2)\ldots\frac{1}{2}(\id+G_r)
    $$
    onto the simultaneous $+1$ eigenspace of the generators $G_1,\ldots,G_r$ can be written as
    $$
      P = \frac{1}{2^r}(S_1+S_2+\ldots+S_{2^r})
    $$
    where the sum contains all elements $S_i$ of $\mathcal{S}$.
3. The fact that independent generators consecutively bisect the total Hilbert space relies on the fact that, if $G_1$ and $G_2$ are independent generators, then $G_2$ restricted to the $+1$ eigenspace of $G_1$ bisects it into two subspaces of equal dimension.
    Explain how this fact follows from
    $$
      \tr\left[
        \frac{1}{2}(\id+G_1)G_2\frac{1}{2}(\id+G_1)
      \right] = 0
    $$
    and prove that this trace is indeed zero.
    Why do the two generators $G_1$ and $G_2$ have to be independent?


### Equivalent projective measurements {#equivalent-projective-pauli-measurements}

In Section \@ref(measuring-pauli-stabilisers) we described a generic method for constructing projective measurements of Pauli observables.
However, sometimes it may be easier to use equivalent, simpler constructions.
For example, the following two circuit identities are often used:

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=4}
\begin{quantikz}
  \lstick{$\ket{0}$}
  &\gate{H}
  &\ctrl{1}
  &\gate{H}
  &\meterD{}
\\\lstick{$\ket{\psi}$}
  &\qw
  &\gate{X}
  &\qw
  &\qw
  \end{quantikz}
  =
  \begin{quantikz}
  \lstick{$\ket{0}$}
  &\qw
  &\targ
  &\qw
  &\qw
  &\meterD{}
\\\lstick{$\ket{\psi}$}
  &\gate{H}
  &\ctrl{-1}
  &\gate{H}
  &\qw
\end{quantikz}
```

```{r,engine='tikz',engine.opts=list(template="tikz2pdf.tex"),fig.width=4}
\begin{quantikz}
  \lstick{$\ket{0}$}
  &\gate{H}
  &\ctrl{1}
  &\gate{H}
  &\meterD{}
\\\lstick{$\ket{\psi}$}
  &\qw
  &\gate{Z}
  &\qw
  &\qw
  \end{quantikz}
  =
  \begin{quantikz}
  \lstick{$\ket{0}$}
  &\qw
  &\targ
  &\qw
  &\qw
  &\meterD{}
\\\lstick{$\ket{\psi}$}
  &\qw
  &\ctrl{-1}
  &\qw
  &\qw
\end{quantikz}
```

These both follows from the fact that $HZH=X$, and that the control and the target of a controlled-$Z$ gate can be chosen arbitrarily, since the gate itself is symmetric with respect to this choice (the phase flip only happens when both qubits are in state $\ket{1}$).
